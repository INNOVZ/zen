(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{70:(e,t,s)=>{Promise.resolve().then(s.bind(s,4700)),Promise.resolve().then(s.bind(s,3635)),Promise.resolve().then(s.bind(s,6182)),Promise.resolve().then(s.bind(s,4249)),Promise.resolve().then(s.bind(s,1539))},991:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});var a=s(5155);s(2115);var r=s(6657),n=s(4269);function i(e){let{className:t,value:s,...i}=e;return(0,a.jsx)(r.bL,{"data-slot":"progress",className:(0,n.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...i,children:(0,a.jsx)(r.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})}},1539:(e,t,s)=>{"use strict";s.d(t,{Rs:()=>c,SubscriptionProvider:()=>o});var a=s(5155),r=s(2115),n=s(2504),i=s(1643);let l=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[s,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[h,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await n.k.getPlans();d(e)}catch(e){console.error("Failed to load subscription plans:",e),x("Failed to load subscription plans")}})()},[]),(0,r.useEffect)(()=>{let e=async()=>{try{m(!0),x(null);let{userId:e,orgId:t}=await (0,i.F)(),s=null,a="";if(t)try{s=await n.k.getSubscriptionStatus("organization",t),a="organization",console.log("Found organization subscription:",s)}catch(e){console.log("No organization subscription found, trying user subscription"),s=null}if(!s||!1===s.has_subscription)try{s=await n.k.getSubscriptionStatus("user",e),a="user",console.log("Found user subscription:",s)}catch(e){console.log("No user subscription found either"),s=null}if(s&&!1!==s.has_subscription){let e={subscription_id:s.subscription_id||"",tokens_used_this_month:s.tokens_used_this_month||0,tokens_remaining:s.tokens_remaining||0,monthly_limit:s.monthly_limit||0,usage_percentage:s.usage_percentage||0,reset_date:s.reset_date||"",plan_name:s.plan_name||"Basic Plan"};o(e),console.log("Successfully loaded ".concat(a," subscription:"),e)}else console.log("No subscription found for user or organization"),o(null),x("No subscription found. Please contact admin to set up your subscription.")}catch(e){console.error("Failed to load subscription status:",e),e instanceof Error?e.message.includes("Not authenticated")?(o(null),x(null)):e.message.includes("Failed to fetch subscription status: 500")?(o(null),x("No subscription found. Please contact admin to set up your subscription.")):x("Failed to load subscription status"):x("Failed to load subscription status")}finally{m(!1)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]);let g=async()=>{try{x(null);let{userId:e,orgId:t}=await (0,i.F)(),s=null,a="";if(t)try{s=await n.k.getSubscriptionStatus("organization",t),a="organization",console.log("Refreshed organization subscription:",s)}catch(e){console.log("No organization subscription found, trying user subscription"),s=null}if(!s||!1===s.has_subscription)try{s=await n.k.getSubscriptionStatus("user",e),a="user",console.log("Refreshed user subscription:",s)}catch(e){console.log("No user subscription found either"),s=null}if(s&&!1!==s.has_subscription){let e={subscription_id:s.subscription_id||"",tokens_used_this_month:s.tokens_used_this_month||0,tokens_remaining:s.tokens_remaining||0,monthly_limit:s.monthly_limit||0,usage_percentage:s.usage_percentage||0,reset_date:s.reset_date||"",plan_name:s.plan_name||"Basic Plan"};o(e),console.log("Successfully refreshed ".concat(a," subscription:"),e)}else o(null),x("No subscription found. Please contact admin to set up your subscription.")}catch(e){console.error("Failed to refresh subscription status:",e),x("Failed to refresh subscription status")}},p=async e=>{try{let{userId:t,orgId:s}=await (0,i.F)(),a=null;if(s)try{a=await n.k.checkTokenAvailability("organization",s,e),console.log("Checked organization token availability:",a)}catch(e){console.log("No organization subscription found, trying user subscription"),a=null}if(!a)try{a=await n.k.checkTokenAvailability("user",t,e),console.log("Checked user token availability:",a)}catch(e){console.log("No user subscription found either"),a=null}if(a)return a;return{success:!1,has_enough_tokens:!1,tokens_required:e,tokens_available:0,can_proceed:!1}}catch(t){return console.error("Failed to check token availability:",t),{success:!1,has_enough_tokens:!1,tokens_required:e,tokens_available:0,can_proceed:!1}}},f=async e=>{try{let t=await n.k.consumeTokens(e);return await g(),t}catch(e){throw console.error("Failed to consume tokens:",e),e}};return(0,a.jsx)(l.Provider,{value:{subscription:s,plans:c,isLoading:u,error:h,refreshSubscription:g,checkTokenAvailability:p,consumeTokens:f},children:t})},c=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useSubscription must be used within a SubscriptionProvider");return e}},1647:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(5155);s(2115);var r=s(3101),n=s(4269);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...r})}},2754:(e,t,s)=>{"use strict";s.d(t,{N:()=>a,d:()=>r});let a=e=>e&&(e.display_name||e.name||e.email)||"User",r=e=>{let t=a(e);return t.includes("@")?"User":t.split(" ")[0]}},2890:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});let a=(0,s(8090).UU)("https://raoonyyrzzftdenvknfi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJhb29ueXlyenpmdGRlbnZrbmZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNDM1NzcsImV4cCI6MjA2NTgxOTU3N30.3t9rTN6x533lihs8ebUVHu9kuayFl_m2b6liifW1B88")},3635:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(5155),r=s(2115);function n(e){let{children:t,fallback:s=null}=e,[n,i]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{i(!0)},[]),n)?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(a.Fragment,{children:s})}},4249:(e,t,s)=>{"use strict";s.d(t,{Toaster:()=>i});var a=s(5155),r=s(5379),n=s(8720);let i=e=>{let{...t}=e,{theme:s="system"}=(0,r.D)();return(0,a.jsx)(n.l$,{theme:s,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})}},4700:(e,t,s)=>{"use strict";s.d(t,{default:()=>f});var a=s(5155),r=s(2115),n=s(5937),i=s(8192),l=s(4033),o=s(7125),c=s(5229),d=s(508),u=s(8085),m=s(3998),h=s(5142),x=s(4739),g=s(5239),p=s(5704);function f(e){let{position:t="bottom-right",chatbotId:s,showChatbotSelector:f=!1}=e,[b,v]=(0,r.useState)(!1),[y,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)([]),[_,k]=(0,r.useState)(""),[A,S]=(0,r.useState)(!1),[z,C]=(0,r.useState)(),[E,F]=(0,r.useState)([]),[I,P]=(0,r.useState)(null),[D,B]=(0,r.useState)(!0),[T,U]=(0,r.useState)(!1),[R,L]=(0,r.useState)(null),[Z,H]=(0,r.useState)(!1),$=(0,r.useRef)(null),{getErrorMessage:J}=function(){let e=(0,r.useCallback)(e=>e instanceof Error&&(e.message.includes("Unable to connect")||e.message.includes("server unavailable")||e.message.includes("ECONNREFUSED")||e.message.includes("network")||e.message.includes("timeout")),[]),t=(0,r.useCallback)(t=>t instanceof Error?e(t)?"Unable to connect to server. Please check if the backend service is running and try again.":t.message.includes("Not authenticated")||t.message.includes("Authentication expired")?"Your session has expired. Please log in again.":t.message.includes("Access denied")||t.message.includes("Unauthorized")?"You don't have permission to perform this action.":t.message.includes("timeout")?"The request timed out. Please try again.":t.message||"An unexpected error occurred":"An unexpected error occurred",[e]);return{isConnectionError:e,getErrorMessage:t}}();(0,r.useEffect)(()=>{H(!0)},[]),(0,r.useEffect)(()=>{(async()=>{try{B(!0);let e=await x.kQ.getCurrentUserContext();if(L(e.isAuthenticated),!e.isAuthenticated)return void w([{id:"greeting",type:"bot",content:"Hello! To use the chat feature, please log in to your account first.",timestamp:new Date}]);let t=await x.Ex.getChatbots();if(t&&t.length>0){F(t);let e=null;if(s&&(e=t.find(e=>e.id===s)||null),e||(e=t.find(e=>"active"===e.chain_status)||t[0]),e){let t=await x.Ex.getChatbot(e.id);P(t),w([{id:"greeting",type:"bot",content:t.greeting_message||"Hello! I'm ".concat(t.name,". How can I help you today?"),timestamp:new Date}])}}else w([{id:"greeting",type:"bot",content:"Hello! I'm your AI assistant. Please note that no chatbots are currently configured for your organization.",timestamp:new Date}])}catch(e){if(console.error("Error loading chatbots:",e),e instanceof Error&&e.message.includes("Not authenticated"))L(!1),w([{id:"greeting",type:"bot",content:"Hello! To use the chat feature, please log in to your account first.",timestamp:new Date}]);else{let t=J(e);w([{id:"greeting",type:"bot",content:"Hello! ".concat(t),timestamp:new Date}])}}finally{B(!1)}})()},[s,J]);let O=async e=>{try{let t=await x.Ex.getChatbot(e);P(t),C(void 0),w([{id:"greeting",type:"bot",content:t.greeting_message||"Hello! I'm ".concat(t.name,". How can I help you today?"),timestamp:new Date}]),U(!1)}catch(e){console.error("Error switching chatbot:",e)}};(0,r.useEffect)(()=>{var e;null==(e=$.current)||e.scrollIntoView({behavior:"smooth"})},[N]);let V=async()=>{if(!_.trim()||A||!R)return;let e={id:Date.now().toString(),type:"user",content:_,timestamp:new Date};w(t=>[...t,e]),k(""),S(!0);try{let e=await x.kQ.sendMessage(_,(null==I?void 0:I.id)||s,z);e.conversation_id&&!z&&C(e.conversation_id);let t={id:(Date.now()+1).toString(),type:"bot",content:e.response,timestamp:new Date,sources:e.sources||[]};w(e=>[...e,t])}catch(s){console.error("Error getting bot response:",s),s instanceof Error&&(s.message.includes("Not authenticated")||s.message.includes("Authentication expired"))&&L(!1);let e=J(s),t={id:(Date.now()+1).toString(),type:"bot",content:e,timestamp:new Date};w(e=>[...e,t])}finally{S(!1)}},X={"bottom-right":"bottom-10 right-4","bottom-left":"bottom-10 left-4"};return Z?b?(0,a.jsx)("div",{className:"fixed ".concat(X[t]," flex flex-col p-0 z-50"),children:(0,a.jsxs)("div",{className:"w-[25vw] flex flex-col shadow-2xl rounded-lg p-3 transition-all bg-white m-0 duration-300 ".concat(y?"h-14":"h-[70vh]"),children:[(0,a.jsx)("div",{className:"flex-row items-center justify-between space-y-0 p-3 text-white rounded-lg shadow-md",style:{background:(null==I?void 0:I.color_hex)?"linear-gradient(135deg, ".concat(I.color_hex,", ").concat(I.color_hex,"dd)"):"linear-gradient(135deg, #3B82F6, #2563EB)"},children:(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center gap-5 flex-1",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("div",{className:"w-9 h-9 rounded-full flex flex-row items-center justify-center bg-white/20",children:(null==I?void 0:I.avatar_url)?(0,a.jsx)(g.default,{src:I.avatar_url.includes("storage/v1/object/uploads/")?"".concat(p.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8001","/api/uploads/avatar/legacy/").concat(I.avatar_url.split("storage/v1/object/uploads/")[1]):I.avatar_url,alt:I.name,width:30,height:30,unoptimized:!0,className:"w-9 h-9 rounded-full"}):(0,a.jsx)(i.A,{className:"h-4 w-4 text-white"})}),f&&E.length>1?(0,a.jsxs)("div",{className:"relative gap-3",children:[(0,a.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>U(!T),className:"h-auto p-1 text-white hover:bg-white/20 flex items-center gap-1",children:[(0,a.jsx)("span",{className:"font-medium text-sm",children:(null==I?void 0:I.name)||"Select Chatbot"}),(0,a.jsx)(l.A,{className:"h-3 w-3"})]}),T&&(0,a.jsx)("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-md shadow-lg border z-10 min-w-48",children:E.map(e=>(0,a.jsxs)("button",{onClick:()=>O(e.id),className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color_hex||"#3B82F6"}}),(0,a.jsx)("span",{children:e.name}),"active"===e.chain_status&&(0,a.jsx)("span",{className:"text-xs text-green-600 ml-auto",children:"Active"})]},e.id))})]}):(0,a.jsx)("span",{className:"font-medium text-sm",children:(null==I?void 0:I.name)||"Assistant"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full"})]}),(0,a.jsxs)("span",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>j(!y),className:"pointer h-7 w-7 rounded-lg p-0 text-white bg-white/20",children:(0,a.jsx)(o.A,{className:"h-3 w-3"})}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>v(!1),className:"pointer h-7 w-7 rounded-lg p-0 bg-white",children:(0,a.jsx)(c.A,{className:"h-3 w-3",style:{color:null==I?void 0:I.color_hex}})})," "]})]})}),!y&&(0,a.jsxs)("div",{className:"relative flex-1 flex flex-col overflow-scroll",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[!1===R&&(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)(i.A,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),(0,a.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Login Required"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"Please log in to your account to start chatting with our AI assistant."}),(0,a.jsx)(m.$,{size:"sm",onClick:()=>window.location.href="/login",className:"bg-blue-600 hover:bg-blue-700",children:"Go to Login"})]})}),N.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"max-w-[85%] p-2 rounded-lg text-sm ".concat("user"===e.type?"text-white ml-2":"bg-gray-100 mr-2"),style:{backgroundColor:"user"===e.type?(null==I?void 0:I.color_hex)||"#3B82F6":void 0},children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:["bot"===e.type&&(0,a.jsx)(i.A,{className:"h-3 w-3 text-blue-500 mt-0.5 flex-shrink-0"}),"user"===e.type&&(0,a.jsx)(d.A,{className:"h-3 w-3 text-white mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:e.content}),e.sources&&e.sources.length>0&&(0,a.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:["Sources: ",e.sources.length," document(s)"]})]})]})})},e.id)),A&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-gray-100 mr-2 p-2 rounded-lg max-w-[85%]",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.A,{className:"h-3 w-3 text-blue-500"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-100"}),(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-200"})]})]})})}),(0,a.jsx)("div",{ref:$})]}),(0,a.jsxs)("div",{className:"p-2 border-t bg-gray-50 ",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.p,{value:_,onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),V())},placeholder:R?"Ask ".concat((null==I?void 0:I.name)||"Assistant","..."):"Please log in to chat...",className:"flex-1 text-sm focus:ring-1 focus:ring-opacity-50 focus:border-transparent transition-all duration-200",style:{"--tw-ring-color":(null==I?void 0:I.color_hex)||"#3B82F6"},disabled:A||!I||!R}),(0,a.jsx)(m.$,{onClick:V,disabled:!_.trim()||A||!I||!R,size:"sm",className:"px-3",style:{backgroundColor:(null==I?void 0:I.color_hex)||"#3B82F6"},children:(0,a.jsx)(u.A,{className:"h-3 w-3"})})]}),(0,a.jsx)("p",{className:"mt-3 text-xs text-right",children:"Powered by Zaakiy"})]})]})]})}):(0,a.jsx)("div",{className:"fixed ".concat(X[t]," z-50"),children:(0,a.jsx)(m.$,{onClick:()=>v(!0),className:"pointer rounded-full w-14 h-14 shadow-lg hover:shadow-xl transition-all duration-200",style:{backgroundColor:(null==I?void 0:I.color_hex)||"#3B82F6"},disabled:D,children:D?(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,a.jsx)(n.A,{className:"h-6 w-6 text-white"})})}):null}},5142:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(5155);s(2115);var r=s(4269);function n(e){let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},6182:(e,t,s)=>{"use strict";s.d(t,{default:()=>I});var a=s(5155),r=s(2115),n=s(2619),i=s.n(n),l=s(63),o=s(5993),c=s(1473),d=s(3007),u=s(5870),m=s(7937),h=s(368),x=s(508),g=s(4926),p=s(630),f=s(2890),b=s(3998),v=s(8720),y=s(2754),j=s(6948),N=s(991),w=s(1647),_=s(8332),k=s(1539),A=s(5299),S=s(2056),z=s(9559),C=s(6154),E=s(6485);let F=e=>{let{className:t,showRefreshButton:s=!0}=e,{subscription:r,isLoading:n,error:i,refreshSubscription:l}=(0,k.Rs)(),o=e=>new Intl.NumberFormat().format(e);if(n)return(0,a.jsx)(j.Zp,{className:t,children:(0,a.jsx)(j.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)(A.A,{className:"h-5 w-5 animate-spin"}),(0,a.jsx)("span",{className:"text-sm",children:"Loading subscription..."})]})})});if(i)return(0,a.jsx)(j.Zp,{className:t,children:(0,a.jsx)(j.Wu,{className:"p-6",children:(0,a.jsxs)(_.Fc,{variant:"destructive",children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),(0,a.jsxs)(_.TN,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:i}),s&&(0,a.jsx)(z.A,{className:"h-4 w-4 cursor-pointer hover:rotate-180 transition-transform",onClick:l})]})]})})});if(!r)return(0,a.jsx)(j.Zp,{className:t,children:(0,a.jsx)(j.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)(C.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No subscription found"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Please contact admin to set up your subscription"})]})})});let c=r.usage_percentage,d=c>=80,u=c>=95;return(0,a.jsxs)(j.Zp,{className:t,children:[(0,a.jsx)(j.aR,{className:"pb-3",children:(0,a.jsxs)(j.ZB,{className:"flex items-center justify-between text-lg",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 mr-2 text-blue-500"}),"Subscription Status"]}),s&&(0,a.jsx)(z.A,{className:"h-4 w-4 cursor-pointer hover:rotate-180 transition-transform text-gray-400",onClick:l})]})}),(0,a.jsxs)(j.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Current Plan"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:r.plan_name||"Basic Plan"})]}),u?(0,a.jsx)(w.E,{className:"bg-red-100 text-red-800",children:"At Limit"}):d?(0,a.jsx)(w.E,{className:"bg-yellow-100 text-yellow-800",children:"Near Limit"}):(0,a.jsx)(w.E,{className:"bg-green-100 text-green-800",children:"Healthy"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Token Usage"}),(0,a.jsxs)("span",{className:"font-medium",children:[o(r.tokens_used_this_month)," /"," ",o(r.monthly_limit)]})]}),(0,a.jsx)(N.k,{value:c,className:"h-2"}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["".concat(c.toFixed(1),"%")," used"]}),(0,a.jsxs)("span",{children:[o(r.tokens_remaining)," remaining"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{children:"Resets"})]}),(0,a.jsx)("span",{className:"font-medium",children:new Date(r.reset_date).toLocaleDateString()})]})]})]})},I=()=>{var e,t;let[s,n]=(0,r.useState)(!0),[j,N]=(0,r.useState)(null),w=(0,l.usePathname)(),_=(0,l.useParams)();(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await f.N.auth.getSession();(null==e?void 0:e.user)&&N(e.user)})()},[]);let k=(null==_?void 0:_.userId)||(null==j?void 0:j.id),A=e=>k?"/dashboard/".concat(k).concat(e):"/dashboard".concat(e),S=[{title:"Dashboard",icon:(0,a.jsx)(o.A,{size:20}),path:A("")},{title:"Train",icon:(0,a.jsx)(c.A,{size:20}),path:A("/train")},{title:"AI",icon:(0,a.jsx)(d.A,{size:20}),path:A("/context-settings")},{title:"Customize",icon:(0,a.jsx)(p.bAt,{size:20}),path:A("/customize")},{title:"Settings",icon:(0,a.jsx)(u.A,{size:20}),path:A("/settings")}],z=async()=>{let{error:e}=await f.N.auth.signOut();e?v.oR.error("Error logging out"):(v.oR.success("Logged out successfully"),window.location.href="/auth/login")};return(0,a.jsxs)("div",{className:"".concat(s?"w-[4vw]":"sm:w-60 w-60 z-[999]"," min-h-screen bg-white text-white transition-all-ease-in-out duration-400 fixed left-0 top-0 flex flex-col"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-r border-gray-700 overflow-y-auto",children:[!s&&(0,a.jsx)("span",{className:"text-xl font-bold text-white",children:"Zentria Pro"}),(0,a.jsx)("button",{onClick:()=>n(!s),className:"pointer",children:s?(0,a.jsxs)("span",{className:"glass shadow-sm p-2 rounded-full flex items-center justify-center",children:[" ",(0,a.jsx)(m.A,{size:20,color:"#fff"})]}):(0,a.jsx)("span",{className:"glass shadow-sm p-2 rounded-full flex items-center justify-center",children:(0,a.jsx)(h.A,{size:20,color:"#fff"})})})]}),!s&&j&&(0,a.jsx)("div",{className:"p-4 border-r border-gray-700 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(x.A,{size:16,className:"text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-white truncate",children:(0,y.N)({id:j.id,email:j.email||"",name:(null==(e=j.user_metadata)?void 0:e.name)||"",display_name:(null==(t=j.user_metadata)?void 0:t.display_name)||""})}),(0,a.jsxs)("p",{className:"text-xs text-white",children:["User ID: ",j.id.slice(0,8),"..."]})]})]})}),(0,a.jsx)("nav",{className:"p-4 flex-1 border-r border-gray-700 overflow-y-auto",children:(0,a.jsx)("ul",{className:"space-y-2",children:S.map((e,t)=>{let r=e.path.replace(/\/$/,""),n=w.replace(/\/$/,""),l=!1,o=n.split("/").filter(Boolean),c=r.split("/").filter(Boolean);return l="Dashboard"===e.title?2===o.length&&"dashboard"===o[0]&&void 0!==o[1]&&void 0===o[2]:o[o.length-1]===c[c.length-1],(0,a.jsx)("li",{children:(0,a.jsxs)(i(),{href:e.path,className:"flex items-center gap-4 p-2 rounded-lg transition-colors\n                    ".concat(l?"glass shadow-sm text-white font-bold":"text-[#0a0a60] hover:text-[#020617]","\n                  "),children:[e.icon,!s&&(0,a.jsx)("span",{className:"text-base font-semibold",children:e.title})]})},t)})})}),!s&&(0,a.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,a.jsx)(F,{showRefreshButton:!1})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,a.jsxs)(b.$,{onClick:z,variant:"ghost",className:"w-full justify-start text-gray-600 hover:text-white hover:bg-red-500 ".concat(s?"px-2":""),children:[(0,a.jsx)(g.A,{size:20}),!s&&(0,a.jsx)("span",{className:"ml-4",children:"Logout"})]})})]})}},8332:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>l,TN:()=>o});var a=s(5155);s(2115);var r=s(3101),n=s(4269);let i=(0,r.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(i({variant:s}),t),...r})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}}},e=>{e.O(0,[204,508,720,273,930,741,504,441,493,358],()=>e(e.s=70)),_N_E=e.O()}]);
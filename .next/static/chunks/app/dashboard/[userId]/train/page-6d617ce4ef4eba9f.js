(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[841],{966:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var a=t(5155),r=t(2115),l=t(2890),n=t(5125),i=t(2529),o=t(6132),c=t(6983),d=t(1786),u=t(9559),p=t(1360),m=t(3998),x=t(6948),g=t(1647);function h(){let[e,s]=(0,r.useState)("pdf"),[t,h]=(0,r.useState)(null),[f,b]=(0,r.useState)(""),[v,j]=(0,r.useState)(""),[y,N]=(0,r.useState)([]),[w,k]=(0,r.useState)({}),[A,E]=(0,r.useState)(!1),[U,C]=(0,r.useState)(!0),[z,D]=(0,r.useState)("Loading uploads..."),R="http://localhost:8001",S=async()=>{let{data:{session:e}}=await l.N.auth.getSession();if(!(null==e?void 0:e.access_token))throw Error("Not authenticated. Please log in again.");return{Authorization:"Bearer ".concat(e.access_token)}},_=async()=>{if(!A){E(!0),j("Processing...");try{let s=await S();if("pdf"===e||"json"===e){if(!t)return void j("No file selected");if(t.size>0xa00000)return void j("File size exceeds 10MB limit");if(!({pdf:["application/pdf"],json:["application/json","text/json"]})[e].includes(t.type))return void j("Invalid file type. Please select a ".concat(e.toUpperCase()," file."));console.log("Uploading file:",t.name,"Size:",t.size,"Type:",t.type);let a=new FormData;a.append("file",t);let r=await n.A.post("".concat(R,"/api/uploads/").concat(e),a,{headers:{...s},timeout:6e4,onUploadProgress:e=>{let s=Math.round(100*e.loaded/(e.total||1));j("Uploading... ".concat(s,"%"))}});console.log("Upload response:",r.data),j("".concat(e.toUpperCase()," uploaded successfully! Upload ID: ").concat(r.data.upload_id||r.data.id))}else if("url"===e){if(!f.trim())return void j("URL required");try{new URL(f)}catch(e){j("Please enter a valid URL");return}console.log("Submitting URL:",f);let e=await n.A.post("".concat(R,"/api/uploads/url"),{url:f.trim()},{headers:s,timeout:3e4});console.log("URL response:",e.data),j("URL registered for ingestion! Upload ID: ".concat(e.data.upload_id||e.data.id))}h(null),b("");let a=document.getElementById("file-upload");a&&(a.value=""),setTimeout(()=>{F()},1e3)}catch(t){console.error("Upload error:",t);let e="Unknown error occurred";if(n.A.isAxiosError(t))if(t.response){var s,a;console.log("Response status:",t.response.status),console.log("Response data:",t.response.data),e=(null==(s=t.response.data)?void 0:s.detail)?t.response.data.detail:(null==(a=t.response.data)?void 0:a.message)?t.response.data.message:"string"==typeof t.response.data?t.response.data:"Server error (".concat(t.response.status,")")}else t.request?e="Cannot connect to server - check if backend is running":t.message&&(e=t.message);else t instanceof Error&&(e=t.message);j("Error: ".concat(e))}finally{E(!1)}}},I=async e=>{if(window.confirm("Are you sure you want to delete this upload? This will also remove all associated vectors from the knowledge base.")){k(s=>({...s,[e]:"Deleting..."}));try{let s=await S();console.log("Deleting upload:",e);let t=await n.A.delete("".concat(R,"/api/uploads/").concat(e),{headers:s,timeout:3e4});console.log("Delete response:",t.data),k(s=>({...s,[e]:"Deleted successfully!"})),N(s=>s.filter(s=>s.id!==e)),setTimeout(()=>{k(s=>{let t={...s};return delete t[e],t})},2e3)}catch(r){console.error("Delete error:",r);let a="Failed to delete upload";if(n.A.isAxiosError(r))if(r.response){var s,t;a=(null==(s=r.response.data)?void 0:s.detail)?r.response.data.detail:(null==(t=r.response.data)?void 0:t.message)?r.response.data.message:"string"==typeof r.response.data?r.response.data:"Delete failed (".concat(r.response.status,")")}else r.request?a="Cannot connect to server - check if backend is running":r.message&&(a=r.message);else r instanceof Error&&(a=r.message);k(s=>({...s,[e]:"Error: ".concat(a)})),setTimeout(()=>{k(s=>{let t={...s};return delete t[e],t})},5e3)}}},F=(0,r.useCallback)(async()=>{var e,s,t,a;C(!0),D("Loading uploads...");try{let t=await S();console.log("Fetching uploads...");let a=null;for(let e=0;e<3;e++)try{let s=3e4+15e3*e;console.log("Attempt ".concat(e+1,"/").concat(3," with ").concat(s/1e3,"s timeout")),D("Loading uploads... (attempt ".concat(e+1,"/").concat(3,")"));let a=await n.A.get("".concat(R,"/api/uploads"),{headers:t,timeout:s});console.log("Uploads response:",a.data);let r=a.data.uploads||a.data||[];N(Array.isArray(r)?r:[]),j(""),D("Loading uploads...");return}catch(s){if(console.error("Failed to fetch uploads (attempt ".concat(e+1,"/").concat(3,"):"),s),a=s,n.A.isAxiosError(s)){if(s.response&&s.response.status>=400&&s.response.status<500){console.log("Client error detected, stopping retries");break}if(e<2){let s=Math.min(2e3*Math.pow(2,e),8e3);console.log("Waiting ".concat(s/1e3,"s before retry...")),j("Request timed out, retrying in ".concat(s/1e3," seconds...")),D("Request timed out, retrying in ".concat(s/1e3," seconds...")),await new Promise(e=>setTimeout(e,s));continue}}break}if(a)if(n.A.isAxiosError(a)){let t=a;if("ECONNABORTED"===t.code)j("⚠️ Server is taking longer than expected to respond. This might be due to a large amount of data or server load. You can try refreshing the page or contact support if this persists."),N([]);else{let a=(null==(s=t.response)||null==(e=s.data)?void 0:e.detail)||t.message;j("Error fetching uploads: ".concat(a))}}else a instanceof Error&&j("Error fetching uploads: ".concat(a.message))}catch(e){if(console.error("Failed to fetch uploads:",e),n.A.isAxiosError(e)){let s=(null==(a=e.response)||null==(t=a.data)?void 0:t.detail)||e.message;j("Error fetching uploads: ".concat(s))}else e instanceof Error&&j("Error fetching uploads: ".concat(e.message))}finally{C(!1)}},[R]);return(0,r.useEffect)(()=>{F()},[F]),(0,a.jsx)("div",{className:"mx-auto ml-[4.5vw] bg-white rounded-3xl p-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"xl:col-span-2 space-y-6",children:[(0,a.jsxs)(x.Zp,{children:[(0,a.jsx)(x.aR,{children:(0,a.jsxs)(x.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-5 w-5"}),"Data Ingestion"]})}),(0,a.jsxs)(x.Wu,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex gap-2",children:[{key:"pdf",label:"PDF"},{key:"url",label:"URL"},{key:"json",label:"JSON"}].map(t=>(0,a.jsx)(m.$,{variant:e===t.key?"default":"outline",size:"sm",onClick:()=>s(t.key),children:t.label},t.key))}),"pdf"===e||"json"===e?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors",children:[(0,a.jsx)("input",{type:"file",id:"file-upload",accept:"pdf"===e?".pdf":".json",onChange:e=>{var s;return h((null==(s=e.target.files)?void 0:s[0])||null)},className:"hidden"}),(0,a.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center space-y-3",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 text-gray-400"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Click to upload ",e.toUpperCase()," files"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Max file size: 10MB"})]})]})]}),t&&(0,a.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:t.name}),(0,a.jsxs)("p",{className:"text-xs text-blue-600",children:[(t.size/1024/1024).toFixed(2)," MB"]})]}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>{h(null);let e=document.getElementById("file-upload");e&&(e.value="")},children:"Remove"})]})})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Website URL"}),(0,a.jsx)("input",{type:"url",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/content",value:f,onChange:e=>b(e.target.value)})]}),(0,a.jsx)(m.$,{onClick:_,disabled:A||!t&&"url"!==e||!f&&"url"===e,className:"w-full",size:"lg",children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Submit"]})}),v&&(0,a.jsx)("div",{className:"p-3 rounded-lg text-sm ".concat(v.includes("Error")?"bg-red-50 text-red-800 border border-red-200":v.includes("successfully")?"bg-green-50 text-green-800 border border-green-200":"bg-blue-50 text-blue-800 border border-blue-200"),children:v})]})]}),(0,a.jsxs)(x.Zp,{children:[(0,a.jsx)(x.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(x.ZB,{children:"Recent Uploads"}),(0,a.jsxs)(m.$,{onClick:F,disabled:U,variant:"outline",size:"sm",children:[U?(0,a.jsx)(u.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(u.A,{className:"h-4 w-4"}),"Refresh"]})]})}),(0,a.jsx)(x.Wu,{children:U?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(u.A,{className:"h-6 w-6 animate-spin mr-2"}),z]}):0===y.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"No uploads found."}),(0,a.jsx)("p",{className:"text-sm",children:"Upload some files to get started!"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Type"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Source"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Created"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:y.map(e=>{var s,t;return(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(g.E,{variant:"outline",className:"font-mono",children:e.type.toUpperCase()})}),(0,a.jsx)("td",{className:"py-3 px-4 max-w-xs",children:(0,a.jsx)("div",{className:"truncate",title:e.source,children:e.source})}),(0,a.jsxs)("td",{className:"py-3 px-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(e=>{switch(e){case"completed":return(0,a.jsx)(i.A,{className:"h-4 w-4 text-green-600"});case"failed":return(0,a.jsx)(o.A,{className:"h-4 w-4 text-red-600"});case"processing":return(0,a.jsx)(c.A,{className:"h-4 w-4 text-yellow-600"});default:return(0,a.jsx)(c.A,{className:"h-4 w-4 text-gray-600"})}})(e.status),(0,a.jsx)(g.E,{variant:"outline",className:(e=>{switch(e){case"completed":return"bg-green-100 text-green-800 border-green-200";case"failed":return"bg-red-100 text-red-800 border-red-200";case"processing":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.status),children:e.status})]}),"failed"===e.status&&e.error_message&&(0,a.jsx)("div",{className:"text-xs text-red-600 mt-1",title:e.error_message,children:e.error_message.length>50?e.error_message.substring(0,50)+"...":e.error_message})]}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600",children:new Date(e.created_at).toLocaleString()}),(0,a.jsxs)("td",{className:"py-3 px-4",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(m.$,{onClick:()=>I(e.id),disabled:null==(s=w[e.id])?void 0:s.includes("Deleting"),variant:"destructive",size:"sm",children:(null==(t=w[e.id])?void 0:t.includes("Deleting"))?(0,a.jsx)(u.A,{className:"h-3 w-3 animate-spin"}):(0,a.jsx)(p.A,{className:"h-3 w-3"})})}),w[e.id]&&!w[e.id].includes("Deleting")&&(0,a.jsx)("div",{className:"text-xs mt-1 ".concat(w[e.id].includes("Error")?"text-red-600":"text-green-600"),children:w[e.id]})]})]},e.id)})})]})})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(x.Zp,{className:"bg-gradient-to-br from-cyan-50 to-teal-50 border-cyan-200",children:[(0,a.jsx)(x.aR,{children:(0,a.jsx)(x.ZB,{className:"text-lg flex items-center gap-2",children:"\uD83C\uDFA8 Customization Guide"})}),(0,a.jsx)(x.Wu,{children:(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-2",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-cyan-600",children:"•"}),"Match your brand colors"]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-cyan-600",children:"•"}),"Set appropriate welcome messages"]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-cyan-600",children:"•"}),"Configure widget position"]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-cyan-600",children:"•"}),"Enable/disable features as needed"]})]})})]}),(0,a.jsxs)(x.Zp,{className:"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200",children:[(0,a.jsx)(x.aR,{children:(0,a.jsx)(x.ZB,{className:"text-lg flex items-center gap-2",children:"\uD83D\uDCCA Upload Guidelines"})}),(0,a.jsx)(x.Wu,{children:(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:"Supported Formats:"}),(0,a.jsxs)("ul",{className:"mt-1 space-y-1",children:[(0,a.jsx)("li",{children:"• PDF documents"}),(0,a.jsx)("li",{children:"• JSON data files"}),(0,a.jsx)("li",{children:"• Website URLs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:"Best Practices:"}),(0,a.jsxs)("ul",{className:"mt-1 space-y-1",children:[(0,a.jsx)("li",{children:"• Keep files under 10MB"}),(0,a.jsx)("li",{children:"• Use clear, structured content"}),(0,a.jsx)("li",{children:"• Test with sample questions"})]})]})]})})]})]})]})})}},1647:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var a=t(5155);t(2115);var r=t(3101),l=t(4269);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(n({variant:t}),s),...r})}},2420:(e,s,t)=>{Promise.resolve().then(t.bind(t,966))},2890:(e,s,t)=>{"use strict";t.d(s,{N:()=>a});let a=(0,t(8090).UU)("https://raoonyyrzzftdenvknfi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJhb29ueXlyenpmdGRlbnZrbmZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNDM1NzcsImV4cCI6MjA2NTgxOTU3N30.3t9rTN6x533lihs8ebUVHu9kuayFl_m2b6liifW1B88")},3998:(e,s,t)=>{"use strict";t.d(s,{$:()=>o});var a=t(5155);t(2115);var r=t(2467),l=t(3101),n=t(4269);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:s,variant:t,size:l,asChild:o=!1,...c}=e,d=o?r.DX:"button";return(0,a.jsx)(d,{"data-slot":"button",className:(0,n.cn)(i({variant:t,size:l,className:s})),...c})}},4269:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var a=t(2821),r=t(5889);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}},6948:(e,s,t)=>{"use strict";t.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>l,aR:()=>n});var a=t(5155);t(2115);var r=t(4269);function l(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function n(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function i(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",s),...t})}function c(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",s),...t})}}},e=>{e.O(0,[4554,284,1972,8441,1255,7358],()=>e(e.s=2420)),_N_E=e.O()}]);
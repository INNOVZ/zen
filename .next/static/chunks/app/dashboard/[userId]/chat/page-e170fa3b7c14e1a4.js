(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4083],{1647:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var a=t(5155);t(2115);var r=t(3101),n=t(4269);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:t}),s),...r})}},5142:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(5155);t(2115);var r=t(4269);function n(e){let{className:s,type:t,...n}=e;return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...n})}},5576:(e,s,t)=>{Promise.resolve().then(t.bind(t,9957))},9957:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>I});var a=t(5155),r=t(2115),n=t(5299),l=t(8192),i=t(9559),o=t(1360),c=t(5870),d=t(508),m=t(9715),x=t(8085),u=t(3998),h=t(6948),p=t(5142),g=t(1647),f=t(4739),b=t(4890),j=t(4269);function y(e){let{delayDuration:s=0,...t}=e;return(0,a.jsx)(b.Kq,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function v(e){let{...s}=e;return(0,a.jsx)(y,{children:(0,a.jsx)(b.bL,{"data-slot":"tooltip",...s})})}function N(e){let{...s}=e;return(0,a.jsx)(b.l9,{"data-slot":"tooltip-trigger",...s})}function w(e){let{className:s,sideOffset:t=0,children:r,...n}=e;return(0,a.jsx)(b.ZL,{children:(0,a.jsxs)(b.UC,{"data-slot":"tooltip-content",sideOffset:t,className:(0,j.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...n,children:[r,(0,a.jsx)(b.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function k(e){let{className:s=""}=e,[t,b]=(0,r.useState)([]),[j,k]=(0,r.useState)(""),[A,_]=(0,r.useState)(!1),[C,I]=(0,r.useState)(!1),[E,S]=(0,r.useState)({name:"ZaaKy",avatar_url:"",color_hex:"#6a8fff",tone:"helpful"}),[T,z]=(0,r.useState)(!0),D=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await f.Ex.getChatbots();if(e&&e.length>0){let s=e.find(e=>"active"===e.chain_status)||e[0],t=await f.Ex.getChatbot(s.id);S({name:t.name||"ZaaKy",avatar_url:t.avatar_url||"",color_hex:t.color_hex||"#3B82F6",tone:t.tone||"helpful"}),b([{id:"1",type:"bot",content:"".concat(t.greeting_message),timestamp:new Date}])}}catch(e){console.error("Error loading chatbot config:",e),b([{id:"1",type:"bot",content:"Hello! I'm your AI assistant. How can I help you today?",timestamp:new Date}])}finally{z(!1)}})()},[]),(0,r.useEffect)(()=>{var e;null==(e=D.current)||e.scrollIntoView({behavior:"smooth"})},[t]);let P=async()=>{if(!j.trim()||A)return;let e={id:Date.now().toString(),type:"user",content:j,timestamp:new Date};b(s=>[...s,e]),k(""),_(!0);try{let e=await f.kQ.sendMessage(j),s={id:(Date.now()+1).toString(),type:"bot",content:e.response,timestamp:new Date,sources:e.sources||[]};b(e=>[...e,s]),e.chatbot_config&&S(s=>({...s,...e.chatbot_config}))}catch(s){console.error("Error getting bot response:",s);let e={id:(Date.now()+1).toString(),type:"bot",content:"I apologize, but I'm having trouble processing your request right now. Please try again.",timestamp:new Date};b(s=>[...s,e])}finally{_(!1)}},R=async()=>{I(!0);try{await new Promise(e=>setTimeout(e,2e3)),b(e=>[...e,{id:Date.now().toString(),type:"bot",content:"Training complete! Please note that to retrain with new data, you'll need to upload new training files in the Train section. The chatbot will automatically use the latest uploaded data.",timestamp:new Date}])}catch(e){console.error("Error during retrain process:",e),b(e=>[...e,{id:Date.now().toString(),type:"bot",content:"I'm sorry, there was an error during retraining. Please try again later.",timestamp:new Date}])}finally{I(!1)}};return T?(0,a.jsx)(h.Zp,{className:"h-[600px] flex flex-col ".concat(s),children:(0,a.jsxs)(h.Wu,{className:"flex-1 flex flex-col justify-center items-center p-4",children:[(0,a.jsx)(n.A,{className:"h-8 w-8 text-blue-400 animate-spin mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Loading chatbot..."})]})}):(0,a.jsxs)(h.Zp,{className:"h-[85vh]  flex flex-col ".concat(s),children:[(0,a.jsxs)(h.aR,{className:"flex-row items-center justify-between space-y-0 pb-4",children:[(0,a.jsxs)(h.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:E.color_hex},children:E.avatar_url?(0,a.jsx)("img",{src:E.avatar_url,alt:E.name,className:"w-5 h-5 rounded-full"}):(0,a.jsx)(l.A,{className:"h-3 w-3 text-white"})}),(0,a.jsx)("span",{children:E.name}),(0,a.jsx)(g.E,{variant:"secondary",className:"ml-2",children:"Sandbox Mode"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(u.$,{variant:"outline",size:"sm",onClick:R,disabled:C,className:"text-xs",children:[C?(0,a.jsx)(i.A,{className:"h-3 w-3 animate-spin mr-1"}):(0,a.jsx)(i.A,{className:"h-3 w-3 mr-1"}),C?"Retraining...":"Retrain"]}),(0,a.jsxs)(u.$,{variant:"outline",size:"sm",onClick:()=>{b([{id:"1",type:"bot",content:"Hello! I'm ".concat(E.name,", your AI assistant. How can I help you today?"),timestamp:new Date}])},className:"text-xs",children:[(0,a.jsx)(o.A,{className:"h-3 w-3 mr-1"}),"Clear"]}),(0,a.jsxs)(u.$,{variant:"outline",size:"sm",className:"text-xs",children:[(0,a.jsx)(c.A,{className:"h-3 w-3 mr-1"}),"Configure"]})]})]}),(0,a.jsxs)(h.Wu,{className:"relative flex-1 flex flex-col p-4 overflow-scroll",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 p-2 bg-gray-50 rounded-lg",children:[t.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"max-w-[80%] p-3 rounded-lg ".concat("user"===e.type?"bg-blue-400 text-white ml-4":"bg-white border shadow-sm mr-4"),style:{backgroundColor:"user"===e.type?E.color_hex:void 0},children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:["bot"===e.type&&(0,a.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:E.avatar_url?(0,a.jsx)("img",{src:E.avatar_url,alt:E.name,className:"h-4 w-4 rounded-full"}):(0,a.jsx)(l.A,{className:"h-4 w-4 text-blue-400",style:{color:E.color_hex}})}),"user"===e.type&&(0,a.jsx)(d.A,{className:"h-4 w-4 text-white mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),"bot"===e.type&&e.sources&&e.sources.length>0&&(0,a.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500",children:"Sources:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.sources.map((e,s)=>(0,a.jsx)(y,{children:(0,a.jsxs)(v,{children:[(0,a.jsx)(N,{asChild:!0,children:(0,a.jsxs)(g.E,{variant:"outline",className:"text-xs flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"h-3 w-3"}),(e=>{if(!e)return"Unknown source";let s=e.split("/").pop();return s?s.length>30?s.substring(0,27)+"...":s:e})(e)]})}),(0,a.jsx)(w,{children:(0,a.jsx)("p",{children:e})})]})},s))})]}),(0,a.jsx)("p",{className:"text-xs mt-1 ".concat("user"===e.type?"text-blue-100":"text-gray-500"),children:e.timestamp.toLocaleTimeString()})]})]})})},e.id)),A&&(0,a.jsx)("div",{className:"flex justify-start overflow-scroll",children:(0,a.jsx)("div",{className:"bg-white border shadow-sm mr-4 p-3 rounded-lg max-w-[80%]",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[E.avatar_url?(0,a.jsx)("img",{src:E.avatar_url,alt:E.name,className:"h-4 w-4 rounded-full"}):(0,a.jsx)(l.A,{className:"h-4 w-4",style:{color:E.color_hex}}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full animate-bounce",style:{backgroundColor:E.color_hex}}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full animate-bounce delay-100",style:{backgroundColor:E.color_hex}}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full animate-bounce delay-200",style:{backgroundColor:E.color_hex}})]})]})})}),(0,a.jsx)("div",{ref:D})]}),(0,a.jsxs)("div",{className:"flex gap-2 bottom-0 sticky",children:[(0,a.jsx)(p.p,{value:j,onChange:e=>k(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),P())},placeholder:"Ask ".concat(E.name," anything..."),className:"flex-1",disabled:A}),(0,a.jsx)(u.$,{onClick:P,disabled:!j.trim()||A,size:"sm",style:{backgroundColor:E.color_hex},children:(0,a.jsx)(x.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex justify-between",children:[(0,a.jsxs)("span",{children:[t.length-1," messages â€¢ ",E.tone," tone"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Online"]})]})]})]})}var A=t(6132),_=t(1362),C=t(8090);function I(){let e=(0,C.UU)("https://raoonyyrzzftdenvknfi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJhb29ueXlyenpmdGRlbnZrbmZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNDM1NzcsImV4cCI6MjA2NTgxOTU3N30.3t9rTN6x533lihs8ebUVHu9kuayFl_m2b6liifW1B88"),[s,t]=(0,r.useState)({auth:!1,chatbots:!1,vectors:!1}),[n,l]=(0,r.useState)(!0),[i,o]=(0,r.useState)(null);(0,r.useEffect)(()=>{d()},[]);let c=async()=>{var s;let{data:t}=await e.auth.getSession();return(null==(s=t.session)?void 0:s.access_token)||null},d=async()=>{l(!0),o(null);try{let e=await c();if(!e)throw Error("No authentication token found. Please log in again.");console.log("Testing with token:",e.substring(0,20)+"...");let s=(await fetch("http://localhost:8001/api/auth/me",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok;console.log("Auth test result:",s);let a=!1,r=[];if(s)try{console.log("Testing chatbots endpoint..."),r=await f.Ex.getChatbots(),console.log("Chatbots response:",r),a=Array.isArray(r)&&r.length>0}catch(e){console.error("Chatbot test error:",e)}let n=!1;if(s)try{console.log("Testing vector search...");let e=await f.kQ.sendMessage("Test message to check if vectors are working");console.log("Vector test response:",e),n=!!e.response}catch(e){console.error("Vector test error:",e)}t({auth:s,chatbots:a,vectors:n,message:n?"All systems operational!":s?"Authentication successful, but some services need attention.":"Authentication failed. Please check your login status."})}catch(e){o(e instanceof Error?e.message:"Error connecting to the backend. Please check the server is running."),console.error("Test connections error:",e)}finally{l(!1)}};return(0,a.jsx)("div",{className:"container mx-auto w-full",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 h-full pt-8",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-6 bg-white rounded-lg border shadow-sm",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"RAG Pipeline Test"}),n?(0,a.jsx)("div",{className:"flex items-center justify-center p-6",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):i?(0,a.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md flex items-start gap-2",children:[(0,a.jsx)(A.A,{className:"h-5 w-5 text-red-500 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-800 font-medium",children:"Connection Error"}),(0,a.jsx)("p",{className:"text-sm text-red-600",children:i})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s.auth?(0,a.jsx)(_.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(A.A,{className:"h-5 w-5 text-red-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Authentication"}),(0,a.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:"/api/auth/me"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s.chatbots?(0,a.jsx)(_.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(A.A,{className:"h-5 w-5 text-red-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Chatbot Configuration"}),(0,a.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:"/api/chat/chatbots"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s.vectors?(0,a.jsx)(_.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(A.A,{className:"h-5 w-5 text-red-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Vector Search & RAG"}),(0,a.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:"/api/chat/conversation"})]})]}),(0,a.jsx)("div",{className:"mt-6 p-3 rounded-md ".concat(s.auth&&s.chatbots&&s.vectors?"bg-green-50 text-green-800 border border-green-200":"bg-yellow-50 text-yellow-800 border border-yellow-200"),children:(0,a.jsx)("p",{className:"font-medium",children:s.message})}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(u.$,{onClick:d,size:"sm",children:"Re-run Tests"})})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg border shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"RAG Pipeline Overview"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-1.5 rounded-md text-blue-700",children:"1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"User Query"}),(0,a.jsx)("p",{className:"text-gray-600",children:"User asks a question via the chat interface"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-1.5 rounded-md text-blue-700",children:"2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Query Embedding"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Question converted to vector using OpenAI embeddings API"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-1.5 rounded-md text-blue-700",children:"3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Vector Search"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Pinecone searches for similar document chunks in org namespace"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-1.5 rounded-md text-blue-700",children:"4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Context Building"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Top relevant document chunks combined into context"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-1.5 rounded-md text-blue-700",children:"5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"AI Response"}),(0,a.jsx)("p",{className:"text-gray-600",children:"GPT-4 generates answer using context and chatbot personality"})]})]})]})]})]}),(0,a.jsx)(k,{className:"w-full"})]})})}}},e=>{e.O(0,[4554,284,95,6402,7741,8441,1255,7358],()=>e(e.s=5576)),_N_E=e.O()}]);
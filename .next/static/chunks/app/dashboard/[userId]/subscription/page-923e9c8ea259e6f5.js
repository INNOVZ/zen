(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8788],{293:(e,s,a)=>{"use strict";a.d(s,{T:()=>u});var t=a(5155);a(2115);var n=a(6948),l=a(991),i=a(1647),r=a(3998),c=a(2056),d=a(9559),o=a(6485),x=a(1524),m=a(1539),h=a(4269);let u=e=>{let{className:s,showRefreshButton:a=!0,compact:u=!1}=e,{subscription:j,isLoading:p,error:g,refreshSubscription:f}=(0,m.Rs)();if(p)return(0,t.jsx)(n.Zp,{className:(0,h.cn)("w-full",s),children:(0,t.jsx)(n.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,t.jsx)("div",{className:"h-2 bg-gray-200 rounded"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})});if(g)return(0,t.jsx)(n.Zp,{className:(0,h.cn)("w-full",s),children:(0,t.jsx)(n.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-red-600",children:[(0,t.jsx)(c.A,{size:16}),(0,t.jsx)("span",{className:"text-sm",children:g}),a&&(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:f,className:"ml-auto",children:(0,t.jsx)(d.A,{size:14})})]})})});if(!j)return(0,t.jsx)(n.Zp,{className:(0,h.cn)("w-full",s),children:(0,t.jsx)(n.Wu,{className:"p-6",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{className:"text-sm",children:"No subscription found"})})})});let N=j.usage_percentage,b=N>=80,v=N>=95,y=()=>v?(0,t.jsx)(i.E,{variant:"destructive",className:"text-xs",children:"Critical"}):b?(0,t.jsx)(i.E,{variant:"secondary",className:"text-xs",children:"Warning"}):(0,t.jsx)(i.E,{variant:"outline",className:"text-xs",children:"Healthy"}),w=e=>new Intl.NumberFormat().format(e);return u?(0,t.jsxs)("div",{className:(0,h.cn)("flex items-center space-x-3",s),children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Token Usage"}),y()]}),(0,t.jsx)(l.k,{value:N,className:"h-2",style:{backgroundColor:"#f3f4f6"}}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,t.jsx)("span",{children:w(j.tokens_used_this_month)}),(0,t.jsx)("span",{children:w(j.monthly_limit)})]})]}),a&&(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:f,className:"flex-shrink-0",children:(0,t.jsx)(d.A,{size:14})})]}):(0,t.jsxs)(n.Zp,{className:(0,h.cn)("w-full",s),children:[(0,t.jsx)(n.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(n.ZB,{className:"text-lg font-semibold",children:"Token Usage"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[y(),a&&(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:f,children:(0,t.jsx)(d.A,{size:16})})]})]})}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"This Month"}),(0,t.jsxs)("span",{className:"font-medium",children:[N.toFixed(1),"%"]})]}),(0,t.jsx)(l.k,{value:N,className:"h-3",style:{backgroundColor:"#f3f4f6"}}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:[w(j.tokens_used_this_month)," used"]}),(0,t.jsxs)("span",{children:[w(j.tokens_remaining)," remaining"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:w(j.monthly_limit)}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Monthly Limit"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:w(j.tokens_remaining)}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Remaining"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 pt-2 border-t",children:[(0,t.jsx)(o.A,{size:14}),(0,t.jsxs)("span",{children:["Resets on ",new Date(j.reset_date).toLocaleDateString()]})]}),b&&(0,t.jsx)("div",{className:(0,h.cn)("p-3 rounded-lg text-sm",v?"bg-red-50 text-red-700 border border-red-200":"bg-yellow-50 text-yellow-700 border border-yellow-200"),children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(c.A,{size:16}),(0,t.jsx)("span",{children:v?"You've reached your token limit. Upgrade your plan to continue.":"You're approaching your token limit. Consider upgrading your plan."})]})}),j.tokens_used_this_month>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 pt-2 border-t",children:[(0,t.jsx)(x.A,{size:14}),(0,t.jsx)("span",{children:j.tokens_used_this_month>.5*j.monthly_limit?"High usage this month":"Normal usage this month"})]})]})]})}},1647:(e,s,a)=>{"use strict";a.d(s,{E:()=>r});var t=a(5155);a(2115);var n=a(3101),l=a(4269);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function r(e){let{className:s,variant:a,...n}=e;return(0,t.jsx)("div",{className:(0,l.cn)(i({variant:a}),s),...n})}},4374:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Y});var t=a(5155),n=a(2115),l=a(6948),i=a(3406),r=a(293),c=a(3998),d=a(5142),o=a(6444),x=a(4846),m=a(1647),h=a(9068),u=a(2508),j=a(7586),p=a(5664),g=a(9602),f=a(9451),N=a(5870),b=a(5299),v=a(6132),y=a(2529),w=a(9559),_=a(6046),k=a(2504),C=a(1539),A=a(8720);let S={website:h.A,whatsapp:u.A,messenger:j.A,instagram:p.A,api:g.A,mobile_app:f.A},U=e=>{let{className:s}=e,{subscription:a}=(0,C.Rs)(),[r,h]=(0,n.useState)(null),[u,j]=(0,n.useState)(null),[p,g]=(0,n.useState)(!0),[f,U]=(0,n.useState)(!1),[R,Z]=(0,n.useState)(null),[z,E]=(0,n.useState)("website");(0,n.useEffect)(()=>{(async()=>{try{g(!0),Z(null);let[e,s]=await Promise.all([k.k.getSupportedChannels(),(null==a?void 0:a.subscription_id)?k.k.getChannelConfigurations(a.subscription_id):null]);h(e),j(s),e&&Object.keys(e).length>0&&E(Object.keys(e)[0])}catch(e){console.error("Failed to load channel data:",e),Z("Failed to load channel configurations")}finally{g(!1)}})()},[null==a?void 0:a.subscription_id]);let F=async(e,s)=>{if(null==a?void 0:a.subscription_id)try{U(!0),await k.k.updateChannelConfiguration(a.subscription_id,e,s),A.oR.success("Channel configuration updated for ".concat(e));let t=await k.k.getChannelConfigurations(a.subscription_id);j(t)}catch(s){console.error("Failed to update channel configuration:",s),A.oR.error("Failed to update ".concat(e," configuration"))}finally{U(!1)}},L=e=>{let s=S[e]||N.A;return(0,t.jsx)(s,{className:"w-5 h-5"})};if(p)return(0,t.jsx)(l.Zp,{className:s,children:(0,t.jsx)(l.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-center",children:[(0,t.jsx)(b.A,{className:"w-8 h-8 animate-spin text-blue-500"}),(0,t.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading channel configurations..."})]})})});if(R||!r)return(0,t.jsx)(l.Zp,{className:s,children:(0,t.jsx)(l.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(v.A,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Configuration Unavailable"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:R||"No channel configurations available"}),(0,t.jsx)(c.$,{onClick:()=>window.location.reload(),children:"Try Again"})]})})});let W=Object.entries(r);return(0,t.jsxs)("div",{className:s,children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Channel Configuration"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Configure settings for each communication channel in your subscription."})]}),(0,t.jsxs)(i.tU,{value:z,onValueChange:E,className:"space-y-4",children:[(0,t.jsx)(i.j7,{className:"grid w-full grid-cols-2 md:grid-cols-3 lg:grid-cols-6",children:W.map(e=>{let[s,a]=e;return(0,t.jsxs)(i.Xi,{value:s,className:"flex items-center space-x-2",children:[L(s),(0,t.jsx)("span",{className:"hidden sm:inline capitalize",children:s})]},s)})}),W.map(e=>{var s;let[a,n]=e,r=null==u?void 0:u[a],h=null!=(s=null==r?void 0:r.enabled)&&s;return(0,t.jsx)(i.av,{value:a,className:"space-y-4",children:(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[L(a),(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.ZB,{className:"capitalize",children:[a," Configuration"]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:n.description})]})]}),(0,t.jsx)(m.E,{variant:h?"default":"secondary",children:h?"Enabled":"Disabled"})]})}),(0,t.jsxs)(l.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Channel Details"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Name:"})," ",n.name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Description:"})," ",n.description]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Icon:"})," ",n.icon]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Typical Use Cases"}),(0,t.jsx)("ul",{className:"text-sm space-y-1",children:n.typical_use_cases.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center",children:[(0,t.jsx)(y.A,{className:"w-3 h-3 text-green-500 mr-2"}),e]},s))})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-semibold",children:"Configuration Settings"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{htmlFor:"".concat(a,"-enabled"),className:"font-medium",children:"Enable Channel"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Allow this channel to receive messages"})]}),(0,t.jsx)(x.d,{id:"".concat(a,"-enabled"),checked:h,onCheckedChange:e=>F(a,{enabled:e}),disabled:f})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.J,{htmlFor:"".concat(a,"-rate-limit"),children:"Rate Limit (messages/minute)"}),(0,t.jsx)(d.p,{id:"".concat(a,"-rate-limit"),type:"number",value:(null==r?void 0:r.rate_limit_per_minute)||60,onChange:e=>F(a,{rate_limit_per_minute:parseInt(e.target.value)}),disabled:f,min:"1",max:"1000"})]}),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,t.jsx)(o.J,{htmlFor:"".concat(a,"-webhook"),children:"Webhook URL"}),(0,t.jsx)(d.p,{id:"".concat(a,"-webhook"),type:"url",value:(null==r?void 0:r.webhook_url)||"",onChange:e=>F(a,{webhook_url:e.target.value}),disabled:f,placeholder:"https://your-domain.com/webhook"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"URL to receive webhook notifications for this channel"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.J,{children:"Custom Settings"}),(0,t.jsxs)("div",{className:"p-3 border rounded-lg bg-gray-50",children:[(0,t.jsx)("pre",{className:"text-sm text-gray-600",children:JSON.stringify((null==r?void 0:r.custom_settings)||{},null,2)}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Custom settings are managed by the backend API"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Configuration Status"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Last updated:"," ",(null==r?void 0:r.updated_at)?new Date(r.updated_at).toLocaleString():"Never"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[h?(0,t.jsx)(y.A,{className:"w-5 h-5 text-green-500"}):(0,t.jsx)(v.A,{className:"w-5 h-5 text-yellow-500"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:h?"Active":"Inactive"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[(0,t.jsxs)(c.$,{variant:"outline",onClick:()=>window.location.reload(),disabled:f,children:[(0,t.jsx)(w.A,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,t.jsx)(c.$,{onClick:()=>F(a,{}),disabled:f,children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.A,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})]})},a)})]}),(0,t.jsxs)(l.Zp,{className:"mt-6",children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"Configuration Summary"})}),(0,t.jsx)(l.Wu,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:W.map(e=>{var s;let[a,n]=e,l=null==u?void 0:u[a],i=null!=(s=null==l?void 0:l.enabled)&&s;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[L(a),(0,t.jsx)("span",{className:"capitalize font-medium",children:a})]}),(0,t.jsx)(m.E,{variant:i?"default":"secondary",children:i?"Enabled":"Disabled"})]},a)})})})]})]})};var R=a(4708),Z=a(5229),z=a(4269);function E(e){let{...s}=e;return(0,t.jsx)(R.bL,{"data-slot":"dialog",...s})}function F(e){let{...s}=e;return(0,t.jsx)(R.ZL,{"data-slot":"dialog-portal",...s})}function L(e){let{className:s,...a}=e;return(0,t.jsx)(R.hJ,{"data-slot":"dialog-overlay",className:(0,z.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function W(e){let{className:s,children:a,showCloseButton:n=!0,...l}=e;return(0,t.jsxs)(F,{"data-slot":"dialog-portal",children:[(0,t.jsx)(L,{}),(0,t.jsxs)(R.UC,{"data-slot":"dialog-content",className:(0,z.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...l,children:[a,n&&(0,t.jsxs)(R.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(Z.A,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function P(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,z.cn)("flex flex-col gap-2 text-center sm:text-left",s),...a})}function O(e){let{className:s,...a}=e;return(0,t.jsx)(R.hE,{"data-slot":"dialog-title",className:(0,z.cn)("text-lg leading-none font-semibold",s),...a})}function T(e){let{className:s,...a}=e;return(0,t.jsx)(R.VY,{"data-slot":"dialog-description",className:(0,z.cn)("text-muted-foreground text-sm",s),...a})}var I=a(6154),$=a(8854),M=a(1871),D=a(2056),B=a(5917);let J=e=>{let{isOpen:s,onClose:a,currentTokensUsed:i=0,currentTokensLimit:r=0,tokensRequired:d=0}=e,{plans:o,refreshSubscription:x}=(0,C.Rs)(),[h,u]=(0,n.useState)(!1),[j,p]=(0,n.useState)(null);if(!o)return null;let g=Object.entries(o),f=g.find(e=>{let[s,a]=e;return a.monthly_token_limit===r}),N=g.filter(e=>{let[s,a]=e;return a.monthly_token_limit>r}),b=e=>{switch(e){case"basic":return(0,t.jsx)(I.A,{className:"w-5 h-5 text-blue-500"});case"professional":return(0,t.jsx)($.A,{className:"w-5 h-5 text-purple-500"});case"enterprise":return(0,t.jsx)(M.A,{className:"w-5 h-5 text-green-500"});default:return(0,t.jsx)(I.A,{className:"w-5 h-5 text-gray-500"})}},v=async e=>{u(!0);try{A.oR.success("Upgrade to ".concat(o[e].name," initiated!")),await x(),a()}catch(e){console.error("Upgrade failed:",e),A.oR.error("Upgrade failed. Please try again.")}finally{u(!1)}},y=e=>new Intl.NumberFormat().format(e),w=()=>0===r?0:i/r*100;w();let _=w()>=95;return(0,t.jsx)(E,{open:s,onOpenChange:a,children:(0,t.jsxs)(W,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(P,{children:[(0,t.jsxs)(O,{className:"flex items-center space-x-2",children:[(0,t.jsx)(D.A,{className:"w-6 h-6 text-yellow-500"}),(0,t.jsx)("span",{children:"Upgrade Your Plan"})]}),(0,t.jsx)(T,{children:_?"You've reached your token limit. Upgrade to continue using the service.":"You're approaching your token limit. Upgrade now to avoid interruption."})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(l.Zp,{className:"bg-yellow-50 border-yellow-200",children:(0,t.jsxs)(l.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-yellow-800",children:"Current Usage"}),(0,t.jsxs)("p",{className:"text-sm text-yellow-700",children:[y(i)," /"," ",y(r)," tokens used"]})]}),(0,t.jsxs)(m.E,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[w().toFixed(1),"% Used"]})]}),d>0&&(0,t.jsxs)("div",{className:"mt-2 text-sm text-yellow-700",children:[(0,t.jsx)("strong",{children:"Tokens needed:"})," ",y(d)]})]})}),f&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Current Plan"}),(0,t.jsx)(l.Zp,{className:"bg-gray-50 border-gray-200",children:(0,t.jsx)(l.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[b(f[0]),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:f[1].name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[y(f[1].monthly_token_limit)," ","tokens/month"]})]})]})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Upgrade Options"}),(0,t.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:N.map(e=>{let[s,a]=e;return(0,t.jsxs)(l.Zp,{className:"cursor-pointer transition-all ".concat((e=>{switch(e){case"basic":return"border-blue-200 hover:border-blue-300";case"professional":return"border-purple-200 hover:border-purple-300";case"enterprise":return"border-green-200 hover:border-green-300";default:return"border-gray-200 hover:border-gray-300"}})(s)," ").concat(j===s?"ring-2 ring-blue-500":""),onClick:()=>p(s),children:[(0,t.jsx)(l.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[b(s),(0,t.jsx)(l.ZB,{className:"text-lg",children:a.name})]}),(0,t.jsx)(m.E,{variant:"outline",children:"Upgrade"})]})}),(0,t.jsxs)(l.Wu,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["$",a.price_per_month,(0,t.jsx)("span",{className:"text-sm font-normal text-gray-500",children:"/month"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"w-4 h-4 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm",children:[y(a.monthly_token_limit)," tokens/month"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"w-4 h-4 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm",children:[a.max_chatbots," chatbots"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"w-4 h-4 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm",children:[a.max_documents_per_chatbot," documents per chatbot"]})]}),a.priority_support&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"w-4 h-4 text-green-500"}),(0,t.jsx)("span",{className:"text-sm",children:"Priority support"})]}),a.custom_branding&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"w-4 h-4 text-green-500"}),(0,t.jsx)("span",{className:"text-sm",children:"Custom branding"})]}),a.api_access&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"w-4 h-4 text-green-500"}),(0,t.jsx)("span",{className:"text-sm",children:"API access"})]})]}),(0,t.jsx)(c.$,{className:"w-full",onClick:()=>v(s),disabled:h,children:h?"Processing...":"Upgrade to ".concat(a.name)})]})]},s)})})]}),(0,t.jsx)(l.Zp,{className:"bg-blue-50 border-blue-200",children:(0,t.jsxs)(l.Wu,{className:"p-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"Benefits of Upgrading"}),(0,t.jsxs)("ul",{className:"space-y-1 text-sm text-blue-700",children:[(0,t.jsx)("li",{children:"• Higher token limits for more conversations"}),(0,t.jsx)("li",{children:"• More chatbots and document capacity"}),(0,t.jsx)("li",{children:"• Priority support for faster resolution"}),(0,t.jsx)("li",{children:"• Advanced features like API access and custom branding"}),(0,t.jsx)("li",{children:"• Longer analytics retention for better insights"})]})]})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,t.jsx)(c.$,{variant:"outline",onClick:a,children:"Maybe Later"}),j&&(0,t.jsx)(c.$,{onClick:()=>v(j),disabled:h,className:"bg-blue-600 hover:bg-blue-700",children:h?"Processing...":"Upgrade Now"})]})]})]})})};function Y(){let{subscription:e,plans:s}=(0,C.Rs)(),{showUpgradeModal:a,tokenError:d,closeUpgradeModal:o}=(()=>{let{subscription:e,consumeTokens:s,checkTokenAvailability:a}=(0,C.Rs)(),[t,l]=(0,n.useState)(!1),[i,r]=(0,n.useState)(null),c=e=>{var s;return console.error("Token error:",e),((null==e?void 0:e.status)===402||(null==e||null==(s=e.detail)?void 0:s.error)==="Insufficient tokens")&&(r(e.detail||e),l(!0),!0)},d=(e,s,a)=>k.k.estimateTokensForOperation(e,s,a),o=async(s,t,n)=>{try{let i=d(s,t,n),c=await a(i);if(!c.has_enough_tokens)return r({error:"Insufficient tokens",tokens_requested:i,tokens_available:c.tokens_available,monthly_limit:(null==e?void 0:e.monthly_limit)||0,reset_date:(null==e?void 0:e.reset_date)||new Date().toISOString()}),l(!0),!1;return!0}catch(e){return console.error("Error checking token availability:",e),!0}},x=async(e,a,t)=>{try{let n=d(e,a,t);return await s({entity_id:"",entity_type:"user",tokens_consumed:n,operation_type:e}),!0}catch(e){return c(e)}},m=async(e,s,a,t)=>{try{if(!await o(s,a,t))return null;let n=await e();return await x(s,a,t),n}catch(e){if(c(e))return null;throw e}};return{handleTokenError:c,estimateTokensForOperation:d,checkTokensBeforeOperation:o,consumeTokensForOperation:x,wrapApiCall:m,showUpgradeModal:t,tokenError:i,closeUpgradeModal:()=>{l(!1),r(null)}}})(),x=(()=>{if(!e||!s)return null;let a=Object.entries(s).find(s=>{let[,a]=s;return a.monthly_token_limit===e.monthly_limit});return a?{key:a[0],plan:a[1]}:null})(),m=!!e&&e.usage_percentage>=80;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Subscription Management"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your subscription, monitor usage, and configure channels"})]}),m&&(0,t.jsxs)(c.$,{variant:"destructive",className:"flex items-center space-x-2",children:[(0,t.jsx)(D.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Upgrade Plan"})]})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsxs)(l.ZB,{className:"flex items-center space-x-2",children:[(0,t.jsx)(I.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Current Plan"})]})}),(0,t.jsx)(l.Wu,{children:x?(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:x.plan.name}),(0,t.jsxs)("p",{className:"text-gray-600",children:["$",x.plan.price_per_month,"/month"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Monthly Token Limit"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:new Intl.NumberFormat().format(x.plan.monthly_token_limit)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Max Chatbots"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:x.plan.max_chatbots})]})]}):(0,t.jsx)("p",{className:"text-gray-600",children:"No subscription plan found"})})]}),(0,t.jsx)(r.T,{}),(0,t.jsxs)(i.tU,{defaultValue:"channels",className:"space-y-4",children:[(0,t.jsxs)(i.j7,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(i.Xi,{value:"channels",className:"flex items-center space-x-2",children:[(0,t.jsx)(N.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Channels"})]}),(0,t.jsxs)(i.Xi,{value:"settings",className:"flex items-center space-x-2",children:[(0,t.jsx)(N.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Settings"})]})]}),(0,t.jsx)(i.av,{value:"channels",children:(0,t.jsx)(U,{})}),(0,t.jsx)(i.av,{value:"settings",children:(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"Subscription Settings"})}),(0,t.jsx)(l.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(N.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Settings Coming Soon"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Advanced subscription settings will be available here."})]})})]})})]}),(0,t.jsx)(J,{isOpen:a,onClose:o,currentTokensUsed:null==e?void 0:e.tokens_used_this_month,currentTokensLimit:null==e?void 0:e.monthly_limit,tokensRequired:null==d?void 0:d.tokens_requested})]})}},4846:(e,s,a)=>{"use strict";a.d(s,{d:()=>r});var t=a(5155),n=a(2115),l=a(7599),i=a(4269);let r=n.forwardRef((e,s)=>{let{className:a,thumbClassName:n,...r}=e;return(0,t.jsx)(l.bL,{className:(0,i.cn)("peer inline-flex h-5 w-10 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:s,children:(0,t.jsx)(l.zi,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0",n)})})});r.displayName=l.bL.displayName},5037:(e,s,a)=>{Promise.resolve().then(a.bind(a,4374))}},e=>{e.O(0,[4554,284,8720,8559,6179,4698,5473,827,8441,1255,7358],()=>e(e.s=5037)),_N_E=e.O()}]);
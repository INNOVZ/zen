"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[504],{2504:(n,t,e)=>{e.d(t,{k:()=>i});var r=e(1643),o=e(7228);let a="http://localhost:8001",i={getPlans:async()=>{let n=(0,o.O)("/api/onboarding/plans"),t=o.n.get(n);if(t)return t;try{let t=await (0,r.v)("/api/onboarding/plans"),e=t.plans||t;return o.n.set(n,e,36e5),e}catch(e){console.error("Error fetching subscription plans:",e);let t={basic:{name:"Basic Plan",monthly_token_limit:1e4,price_per_month:29.99,max_chatbots:3,max_documents_per_chatbot:50,priority_support:!1,custom_branding:!1,api_access:!1,analytics_retention_days:30},professional:{name:"Professional Plan",monthly_token_limit:5e4,price_per_month:99.99,max_chatbots:10,max_documents_per_chatbot:200,priority_support:!0,custom_branding:!0,api_access:!0,analytics_retention_days:90},enterprise:{name:"Enterprise Plan",monthly_token_limit:2e5,price_per_month:299.99,max_chatbots:50,max_documents_per_chatbot:1e3,priority_support:!0,custom_branding:!0,api_access:!0,analytics_retention_days:365}};return o.n.set(n,t,3e5),t}},signup:async n=>{try{return await (0,r.v)("/api/onboarding/admin/signup",{method:"POST",body:JSON.stringify(n)})}catch(n){if(console.error("Error during signup:",n),n instanceof Error&&"AbortError"===n.name)throw Error("Request timed out. Please check if the server is running.");throw n}},getSubscriptionStatus:async(n,t)=>{let e=(0,o.O)("/api/onboarding/subscription/".concat(n,"/").concat(t)),a=o.n.get(e);if(a)return a;try{let a=await (0,r.v)("/api/onboarding/subscription/".concat(n,"/").concat(t));return o.n.set(e,a,3e4),a}catch(t){console.error("Error fetching subscription status:",t);let n={subscription_id:"",tokens_used_this_month:0,tokens_remaining:0,monthly_limit:0,usage_percentage:0,reset_date:""};return o.n.set(e,n,6e4),n}},consumeTokens:async n=>{try{let t=await (0,r.v)("/api/onboarding/tokens/consume",{method:"POST",body:JSON.stringify(n)});return o.n.deleteMatching("/api/onboarding/subscription"),t}catch(n){throw console.error("Error consuming tokens:",n),n}},checkTokenAvailability:async(n,t,e)=>{try{return await (0,r.v)("/api/onboarding/tokens/check/".concat(n,"/").concat(t,"/").concat(e))}catch(n){return console.error("Error checking token availability:",n),{success:!0,has_enough_tokens:!0,tokens_required:e,tokens_available:7500,can_proceed:!0}}},getSupportedChannels:async()=>{let n=(0,o.O)("/api/onboarding/channels"),t=o.n.get(n);if(t)return t;try{let t=await fetch("".concat(a,"/api/onboarding/channels"));if(!t.ok)throw Error("Failed to fetch channels: ".concat(t.status));let e=await t.json(),r=e.channels||e;return o.n.set(n,r,36e5),r}catch(e){console.error("Error fetching supported channels:",e);let t={website:{name:"Website Chat",description:"Embedded chat widget on websites",icon:"\uD83C\uDF10",typical_use_cases:["Customer support","Lead generation","FAQ"]},whatsapp:{name:"WhatsApp Business",description:"WhatsApp Business API integration",icon:"\uD83D\uDCF1",typical_use_cases:["Customer service","Order updates","Marketing"]},messenger:{name:"Facebook Messenger",description:"Facebook Messenger integration",icon:"\uD83D\uDCAC",typical_use_cases:["Social commerce","Customer support","Engagement"]},instagram:{name:"Instagram Direct",description:"Instagram Direct Messages integration",icon:"\uD83D\uDCF8",typical_use_cases:["Brand engagement","Product inquiries","Support"]},api:{name:"REST API",description:"API integration for custom applications",icon:"\uD83D\uDD0C",typical_use_cases:["Custom apps","System integration","Automation"]},mobile_app:{name:"Mobile App",description:"Mobile application integration",icon:"\uD83D\uDCF2",typical_use_cases:["In-app support","User onboarding","Feature guidance"]}};return o.n.set(n,t,36e5),t}},getChannelConfigurations:async n=>{let t=(0,o.O)("/api/onboarding/subscription/".concat(n,"/channels/config")),e=o.n.get(t);if(e)return e;try{let e=await fetch("".concat(a,"/api/onboarding/subscription/").concat(n,"/channels/config"));if(!e.ok)throw Error("Failed to fetch channel configurations: ".concat(e.status));let r=await e.json(),i=r.configurations||r;return o.n.set(t,i,3e5),i}catch(n){throw console.error("Error fetching channel configurations:",n),n}},updateChannelConfiguration:async(n,t,e)=>{try{let{token:i,userId:s,orgId:c}=await (0,r.F)(),l={"Content-Type":"application/json",Authorization:"Bearer ".concat(i),"X-User-ID":s};c&&(l["X-Org-ID"]=c);let u=await fetch("".concat(a,"/api/onboarding/subscription/").concat(n,"/channels/").concat(t,"/config"),{method:"PUT",headers:l,body:JSON.stringify(e)});if(!u.ok){let n=await u.json();throw Error(n.detail||"Channel configuration update failed: ".concat(u.status))}let p=await u.json();return o.n.deleteMatching("/api/onboarding/subscription/".concat(n,"/channels")),p}catch(n){throw console.error("Error updating channel configuration:",n),n}},getSubscriptionAnalytics:async function(n){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(!n)throw Error("Subscription ID is required");let e=(0,o.O)("/api/onboarding/analytics/".concat(n,"?days_back=").concat(t)),i=o.n.get(e);if(i)return i;try{let{token:i}=await (0,r.F)(),s=new AbortController,c=setTimeout(()=>s.abort(),3e4),l=await fetch("".concat(a,"/api/onboarding/analytics/").concat(n,"?days_back=").concat(t),{headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},signal:s.signal});if(clearTimeout(c),!l.ok){let n=(await l.json().catch(()=>({}))).detail||"Failed to fetch analytics: ".concat(l.status);throw Error(n)}let u=await l.json(),p=u.analytics||u;return o.n.set(e,p,3e5),p}catch(n){if(console.error("Error fetching subscription analytics:",n),n instanceof Error&&"AbortError"===n.name)throw Error("Request timed out. Please check if the server is running.");throw n}},getChannelComparison:async function(n){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,e=(0,o.O)("/api/onboarding/analytics/".concat(n,"/channels/comparison?days_back=").concat(t)),i=o.n.get(e);if(i)return i;try{let{token:i}=await (0,r.F)(),s=await fetch("".concat(a,"/api/onboarding/analytics/").concat(n,"/channels/comparison?days_back=").concat(t),{headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch channel comparison: ".concat(s.status));let c=await s.json(),l=c.comparison||c;return o.n.set(e,l,3e5),l}catch(n){throw console.error("Error fetching channel comparison:",n),n}},getChannelTrends:async function(n,t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,i=(0,o.O)("/api/onboarding/analytics/".concat(n,"/channels/").concat(t,"/trends?days_back=").concat(e)),s=o.n.get(i);if(s)return s;try{let{token:s}=await (0,r.F)(),c=await fetch("".concat(a,"/api/onboarding/analytics/").concat(n,"/channels/").concat(t,"/trends?days_back=").concat(e),{headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!c.ok)throw Error("Failed to fetch channel trends: ".concat(c.status));let l=await c.json(),u=l.trends||l;return o.n.set(i,u,3e5),u}catch(n){throw console.error("Error fetching channel trends:",n),n}},estimateTokensForOperation:(n,t,e)=>{switch(n){case"chat":return 100+(t||0)/4;case"document_upload":return 500+(e||0)/100;case"document_processing":return 200;case"web_scraping":return 300;case"embedding_generation":return 50;default:return 100}},invalidateSubscriptionCache:()=>{o.n.deleteMatching("/api/onboarding"),console.log("Subscription cache invalidated")},debugSubscriptionEndpoints:async()=>{try{let{userId:n,orgId:t}=await (0,r.F)();console.log("\uD83D\uDD0D Debug: Testing subscription endpoints",{userId:n.substring(0,8)+"...",orgId:(null==t?void 0:t.substring(0,8))+"..."});let e={backendHealth:!1,backendUrl:a,userSubscription:null,orgSubscription:null,plans:null,errors:[]};try{console.log("\uD83D\uDD0D Testing backend health at:",a);let n=await fetch("".concat(a,"/"),{method:"GET",headers:{"Content-Type":"application/json"}});if(e.backendHealth=n.ok,console.log("✅ Backend health:",e.backendHealth,"Status:",n.status),!n.ok){let t=await n.text();console.log("❌ Backend response:",t),e.errors.push({type:"backend",error:"Backend returned ".concat(n.status,": ").concat(t)})}}catch(n){console.error("❌ Backend health error:",n),e.errors.push({type:"backend",error:n instanceof Error?n.message:String(n)})}try{console.log("\uD83D\uDD0D Testing user subscription endpoint..."),e.userSubscription=await i.getSubscriptionStatus("user",n),console.log("✅ User subscription result:",e.userSubscription)}catch(n){console.error("❌ User subscription error:",n),e.errors.push({type:"user",error:n instanceof Error?n.message:String(n)})}if(t)try{console.log("\uD83D\uDD0D Testing organization subscription endpoint..."),e.orgSubscription=await i.getSubscriptionStatus("organization",t),console.log("✅ Organization subscription result:",e.orgSubscription)}catch(n){console.error("❌ Organization subscription error:",n),e.errors.push({type:"organization",error:n instanceof Error?n.message:String(n)})}try{console.log("\uD83D\uDD0D Testing plans endpoint..."),e.plans=await i.getPlans(),console.log("✅ Plans result:",e.plans)}catch(n){console.error("❌ Plans error:",n),e.errors.push({type:"plans",error:n instanceof Error?n.message:String(n)})}return console.log("\uD83D\uDD0D Debug results summary:",e),e}catch(n){return console.error("❌ Debug function error:",n),{error:n instanceof Error?n.message:String(n)}}}}}}]);
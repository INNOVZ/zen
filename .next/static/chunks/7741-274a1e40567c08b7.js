"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7741],{908:(e,t,a)=>{a.d(t,{N:()=>s});var o=a(8090);let r="https://raoonyyrzzftdenvknfi.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJhb29ueXlyenpmdGRlbnZrbmZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNDM1NzcsImV4cCI6MjA2NTgxOTU3N30.3t9rTN6x533lihs8ebUVHu9kuayFl_m2b6liifW1B88";if(!r||!n)throw console.error("Missing Supabase environment variables:"),console.error("NEXT_PUBLIC_SUPABASE_URL:",r?"Set":"Missing"),console.error("NEXT_PUBLIC_SUPABASE_ANON_KEY:",n?"Set":"Missing"),Error("Missing required Supabase environment variables");let s=(0,o.UU)(r,n)},1643:(e,t,a)=>{a.d(t,{F:()=>n,v:()=>s});var o=a(908);let r="http://localhost:8001",n=async()=>{var e,t,a,n;let{data:s,error:i}=await o.N.auth.getSession();if(i)throw console.debug("Auth session error:",i),Error("Authentication error. Please log in again.");let c=null==(e=s.session)?void 0:e.access_token,l=null==(a=s.session)||null==(t=a.user)?void 0:t.id;if(!c||!l)throw console.debug("No valid session found - user not authenticated"),Error("Not authenticated. Please log in again.");let u=null;try{let e=await fetch("".concat(r,"/api/users/profile"),{headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json"}});e.ok&&(u=(null==(n=(await e.json()).user)?void 0:n.org_id)||null)}catch(e){console.debug("Failed to fetch user org_id:",e)}return{token:c,userId:l,orgId:u}},s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{token:a,userId:o,orgId:s}=await n(),i={"Content-Type":"application/json",Authorization:"Bearer ".concat(a),"X-User-ID":o,"X-Request-ID":"req-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),...s&&{"X-Org-ID":s},...t.headers},c=i["X-Request-ID"];console.log("\uD83D\uDD0D [".concat(c,"] API Call:"),"".concat(r).concat(e),{userId:o.substring(0,8)+"...",orgId:(null==s?void 0:s.substring(0,8))+"...",method:t.method||"GET"});let l=Date.now();try{let a=await fetch("".concat(r).concat(e),{...t,headers:i}),o=Date.now()-l;if(console.log("⏱️ [".concat(c,"] Response:"),a.status,"(".concat(o,"ms)")),!a.ok){let o="",n=null,s=null;try{if((o=await a.text())&&(o.startsWith("{")||o.startsWith("[")))try{n=JSON.parse(o)}catch(e){s=e,console.warn("⚠️ [".concat(c,"] JSON parsing failed:"),e)}}catch(e){o="Failed to read error response",console.warn("⚠️ [".concat(c,"] Could not read error response:"),e)}let i={requestId:c,url:"".concat(r).concat(e),method:t.method||"GET",status:a.status,statusText:a.statusText,headers:Object.fromEntries(a.headers.entries()),errorData:n,errorText:o||"No error text",parseError:s instanceof Error?s.message:s?String(s):null,timestamp:new Date().toISOString(),responseTime:Date.now()-l},u={requestId:c,url:i.url,method:i.method,status:i.status,statusText:i.statusText,message:(null==n?void 0:n.message)||o||i.statusText||"Unknown error",timestamp:i.timestamp,fullErrorData:n,fullErrorText:o,responseHeaders:Object.fromEntries(a.headers.entries())},d=e.includes("/context-config"),g=e.includes("/organization");if(404===a.status&&(d||g)?console.debug("\uD83D\uDCDD [".concat(c,"] Endpoint not available (expected in development):"),{url:i.url,status:a.status,endpoint:d?"context-config":"organization"}):(console.error("❌ [".concat(c,"] API Error:"),u),console.error("\uD83D\uDCA5 [".concat(c,"] Request failed:"),{summary:"".concat(i.method," ").concat(i.url," -> ").concat(i.status," ").concat(i.statusText),error:(null==n?void 0:n.message)||o||"No error details available",responseHeaders:Object.fromEntries(a.headers.entries())})),401===a.status)throw Error("Authentication expired. Please log in again.");if(403===a.status)throw Error("Access denied. Please check your permissions.");if(404===a.status)throw Error("API endpoint not found: ".concat(e));else if(429===a.status)throw Error("Too many requests. Please try again later.");else if(a.status>=500)throw Error("Server error. Please try again later.");let h=(null==n?void 0:n.message)||o||a.statusText||"API error (".concat(a.status,")"),p=Error(h);throw p.status=a.status,p.statusText=a.statusText,p.url="".concat(r).concat(e),p.errorData=n,p.errorText=o,p}try{let e=await a.json();return console.log("✅ [".concat(c,"] Success:"),"object"==typeof e?"JSON response":e),e}catch(e){console.error("⚠️ [".concat(c,"] Failed to parse JSON response:"),e),console.error("⚠️ [".concat(c,"] Response status:"),a.status,a.statusText),console.error("⚠️ [".concat(c,"] Response headers:"),Object.fromEntries(a.headers.entries()));try{let e=await a.text();if(console.log("\uD83D\uDCC4 [".concat(c,"] Text response:"),e),!e||""===e.trim())return console.log("\uD83D\uDCC4 [".concat(c,"] Empty response - likely successful update")),{success:!0,message:"Update successful"};return{message:e}}catch(e){throw console.error("\uD83D\uDCA5 [".concat(c,"] Failed to read response as text:"),e),Error("Failed to parse server response")}}}catch(n){let a=Date.now()-l;if(n instanceof TypeError&&n.message.includes("Failed to fetch"))throw console.error("\uD83D\uDCA5 [".concat(c,"] Network error:"),{url:"".concat(r).concat(e),method:t.method||"GET",responseTime:"".concat(a,"ms")}),Error("Backend server unavailable. Please check your connection or try again later.");if(n instanceof Error&&(n.message.includes("ECONNREFUSED")||n.message.includes("network")||n.message.includes("timeout")))throw console.error("\uD83D\uDCA5 [".concat(c,"] Connection error:"),{error:n.message,url:"".concat(r).concat(e),method:t.method||"GET",responseTime:"".concat(a,"ms")}),Error("Unable to connect to server. Please try again later.");let o={error:n,errorMessage:n instanceof Error?n.message:"Unknown error",errorType:typeof n,url:"".concat(r).concat(e),method:t.method||"GET",responseTime:"".concat(a,"ms")};throw n&&"object"==typeof n&&0===Object.keys(n).length?(console.warn("⚠️ [".concat(c,"] Empty error object detected - this might be a successful request with parsing issues")),console.warn("⚠️ [".concat(c,"] Request details:"),{url:o.url,method:o.method,responseTime:o.responseTime})):console.error("\uD83D\uDCA5 [".concat(c,"] Request failed:"),o),n}}},3998:(e,t,a)=>{a.d(t,{$:()=>c});var o=a(5155);a(2115);var r=a(2467),n=a(3101),s=a(4269);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:a,size:n,asChild:c=!1,...l}=e,u=c?r.DX:"button";return(0,o.jsx)(u,{"data-slot":"button",className:(0,s.cn)(i({variant:a,size:n,className:t})),...l})}},4269:(e,t,a)=>{a.d(t,{cn:()=>n});var o=a(2821),r=a(5889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,o.$)(t))}},4739:(e,t,a)=>{a.d(t,{Ex:()=>s,Iu:()=>l,kQ:()=>c,rY:()=>i});var o=a(1643),r=a(7228);let n="http://localhost:8001",s={getChatbots:async()=>{let e=(0,r.O)("/api/chat/chatbots"),t=r.n.get(e);if(t)return t;try{let t=new AbortController,a=setTimeout(()=>{t.abort(Error("Request timeout after 10 seconds"))},1e4),n=await (0,o.v)("/api/chat/chatbots",{signal:t.signal});clearTimeout(a);let s=n.chatbots||n||[];return r.n.set(e,s,12e4),s}catch(e){if(console.error("Error fetching chatbots:",e),e instanceof Error&&("AbortError"===e.name||e.message.includes("timeout")))throw Error("Request timed out. Please try again.");throw e}},getChatbot:async e=>(0,o.v)("/api/chat/chatbots/".concat(e)),createChatbot:async e=>{let{userId:t,orgId:a}=await (0,o.F)(),r=a||"user_".concat(t,"_org"),n={...e,user_id:t,org_id:r};e.ai_model_config&&(n.ai_model_config=e.ai_model_config),console.log("\uD83E\uDD16 Creating chatbot with config:",{...n,user_id:t.substring(0,8)+"...",org_id:r.substring(0,12)+"..."});let s=await (0,o.v)("/api/chat/chatbots",{method:"POST",body:JSON.stringify(n)});return s.chatbot||s},updateChatbot:async(e,t)=>{let a=await (0,o.v)("/api/chat/chatbots/".concat(e),{method:"PUT",body:JSON.stringify(t)});return a.chatbot||a},deleteChatbot:async e=>{await (0,o.v)("/api/chat/chatbots/".concat(e),{method:"DELETE"})},activateChatbot:async e=>{await (0,o.v)("/api/chat/chatbots/".concat(e,"/activate"),{method:"POST"})},healthCheck:async()=>{try{return await (0,o.v)("/api/chat/health")}catch(e){return console.warn("Health check failed:",e),{status:"degraded",timestamp:new Date().toISOString(),services:{database:"error",chat_service:"error",context_engine:"error"},version:"unknown",error:e instanceof Error?e.message:String(e)}}}},i={getUploads:async()=>{let e=(0,r.O)("/api/uploads"),t=r.n.get(e);if(t)return t;try{let t=new AbortController,a=setTimeout(()=>{t.abort(Error("Request timeout after 8 seconds"))},8e3),n=await (0,o.v)("/api/uploads",{signal:t.signal});clearTimeout(a);let s=[];return Array.isArray(n)?s=n:n.uploads&&Array.isArray(n.uploads)?s=n.uploads:n.data&&Array.isArray(n.data)?s=n.data:(console.warn("Unexpected uploads response structure:",n),s=[]),r.n.set(e,s,6e4),s}catch(e){if(console.error("Error fetching uploads:",e),e instanceof Error&&"AbortError"===e.name)throw Error("Request timed out. Please try again.");throw e}},uploadFile:async(e,t)=>{let{token:a,userId:r,orgId:s}=await (0,o.F)(),i=new FormData;i.append("file",e);let c={Authorization:"Bearer ".concat(a),"X-User-ID":r};s&&(c["X-Org-ID"]=s),console.log("\uD83D\uDCE4 Uploading file: ".concat(e.name," (").concat(e.size," bytes) as ").concat(t));let l=await fetch("".concat(n,"/api/uploads/").concat(t),{method:"POST",headers:c,body:i});if(!l.ok){let e=await l.text();throw Error("Upload failed (".concat(l.status,"): ").concat(e))}let u=await l.json();return console.log("✅ File uploaded successfully:",u),u},uploadFileWithTokenHandling:async(e,t,a)=>a?a.wrapApiCall(()=>i.uploadFile(e,t),"document_upload",void 0,e.size):i.uploadFile(e,t),uploadUrl:async e=>(console.log("\uD83D\uDD17 Uploading URL: ".concat(e)),(0,o.v)("/api/uploads/url",{method:"POST",body:JSON.stringify({url:e})})),uploadJson:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"training-data.json";console.log("\uD83D\uDCCB Uploading JSON data: ".concat(t));let a=new File([new Blob([JSON.stringify(e,null,2)],{type:"application/json"})],t,{type:"application/json"});return i.uploadFile(a,"json")},deleteUpload:async e=>{console.log("\uD83D\uDDD1️ Deleting upload: ".concat(e)),await (0,o.v)("/api/uploads/".concat(e),{method:"DELETE"})},reprocessUpload:async e=>(console.log("\uD83D\uDD04 Reprocessing upload: ".concat(e)),(0,o.v)("/api/uploads/".concat(e,"/reprocess"),{method:"POST"})),getUploadStatus:async e=>(0,o.v)("/api/uploads/".concat(e,"/status"))},c={sendMessage:async(e,t,a)=>{try{let r={message:e,...t&&{chatbot_id:t},...a&&{conversation_id:a}};return console.log("\uD83D\uDCE4 Sending message with payload:",{message:e.substring(0,50)+"...",has_chatbot_id:!!t,has_conversation_id:!!a}),await (0,o.v)("/api/chat/conversation",{method:"POST",body:JSON.stringify(r)})}catch(e){throw console.error("Error sending message:",e),e}},sendMessageWithTokenHandling:async(e,t,a,o)=>o?o.wrapApiCall(()=>c.sendMessage(e,t,a),"chat",e.length):c.sendMessage(e,t,a),getConversations:async e=>{try{let t=await (0,o.v)("/api/chat/conversations?limit=".concat(e||(10===e?10:1e4)));return t.conversations||t||[]}catch(e){throw console.error("Error fetching conversations:",e),e}},getConversationCount:async()=>{try{let e=(0,r.O)("conversation-count"),t=r.n.get(e);if("number"==typeof t)return t;let a=await (0,o.v)("/api/chat/conversations?limit=1000"),n=a.conversations||a||[];return r.n.set(e,n.length,3e4),n.length}catch(e){return console.error("Error fetching conversation count:",e),0}},addFeedback:async e=>(0,o.v)("/api/chat/feedback",{method:"POST",body:JSON.stringify(e)}),getContextConfig:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";try{let{token:t,userId:a,orgId:r}=await (0,o.F)(),s={"Content-Type":"application/json",Authorization:"Bearer ".concat(t),"X-User-ID":a,...r&&{"X-Org-ID":r}},i=await fetch("".concat(n,"/api/chat/context-config?config_name=").concat(e),{method:"GET",headers:s});if(!i.ok)return null;return await i.json()}catch(e){return null}},updateContextConfig:async e=>{if(!e||"object"!=typeof e)throw Error("Invalid context config updates provided");let t=Object.fromEntries(Object.entries(e).filter(e=>{let[t,a]=e;return void 0!==a||(console.debug("⚠️ Removing undefined value for key: ".concat(t)),!1)}));console.debug("\uD83D\uDD27 Updating context config with sanitized payload:",{originalKeys:Object.keys(e),sanitizedKeys:Object.keys(t),payload:t});try{let e={config_updates:t};console.debug("\uD83D\uDCE4 Sending request payload:",JSON.stringify(e,null,2));let{token:a,userId:r,orgId:s}=await (0,o.F)(),i={"Content-Type":"application/json",Authorization:"Bearer ".concat(a),"X-User-ID":r,...s&&{"X-Org-ID":s}},c=await fetch("".concat(n,"/api/chat/context-config"),{method:"PUT",headers:i,body:JSON.stringify(e)});if(c.ok){let e=await c.json();return console.debug("✅ Context config update successful"),e||{success:!0,message:"Configuration updated successfully"}}if(404===c.status)return console.debug("⚠️ Context config endpoint not available, using local fallback"),{success:!0,message:"Configuration saved locally (backend endpoint not available)"};if(401!==c.status)return console.warn("⚠️ Context config update failed with status ".concat(c.status)),{success:!0,message:"Configuration saved locally. Server sync will retry automatically."};else throw Error("Session expired. Please refresh the page and try again.")}catch(e){if(console.debug("❌ Context config update error:",e),e instanceof Error){if(e.message.includes("Authentication")||e.message.includes("401"))throw Error("Session expired. Please refresh the page and try again.");if(e.message.includes("fetch")||e.message.includes("network"))return console.debug("⚠️ Network error during context config update, using fallback"),{success:!0,message:"Configuration saved locally. Changes will sync when connection is restored."}}return console.debug("⚠️ Context config update error, providing fallback response"),{success:!0,message:"Configuration saved locally. Some features may not sync until connection is restored."}}},createCustomContextConfig:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"saas",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,o.v)("/api/chat/context-config/custom",{method:"POST",body:JSON.stringify({config_name:e,base_template:t,custom_settings:a})})},getAnalyticsDashboard:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;try{let t=new AbortController,a=setTimeout(()=>{t.abort(Error("Request timeout after 15 seconds"))},15e3),r=await (0,o.v)("/api/chat/analytics/dashboard?days=".concat(e),{signal:t.signal});return clearTimeout(a),r}catch(e){return console.warn("Analytics dashboard not available:",e),e instanceof Error&&("AbortError"===e.name||e.message.includes("timeout"))&&console.warn("Analytics request timed out"),null}},getPerformanceInsights:async()=>{try{return await (0,o.v)("/api/chat/performance-insights")}catch(e){return console.warn("Performance insights not available:",e),null}},getContextAnalytics:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;try{return await (0,o.v)("/api/chat/analytics/context?days=".concat(e))}catch(e){return console.warn("Context analytics not available:",e),null}},analyzeQueryOptimization:async e=>{try{return await (0,o.v)("/api/chat/analytics/query-optimization",{method:"POST",body:JSON.stringify({query:e})})}catch(e){return console.warn("Query optimization not available:",e),null}},exportAnalyticsData:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"json";return(0,o.v)("/api/chat/analytics/export",{method:"POST",body:JSON.stringify({start_date:e,end_date:t,format:a})})},getHealthCheck:async()=>(await fetch("".concat(n,"/api/chat/health"))).json(),getAuthHeaders:async()=>{let{token:e,userId:t,orgId:a}=await (0,o.F)();return{"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"X-User-ID":t,...a&&{"X-Org-ID":a}}},testConnection:async()=>{let e=Date.now();try{return await (0,o.v)("/api/chat/health"),{success:!0,responseTime:Date.now()-e}}catch(t){return{success:!1,responseTime:Date.now()-e,error:t instanceof Error?t.message:"Unknown error"}}},getCurrentUserContext:async()=>{try{let{userId:e,orgId:t}=await (0,o.F)();return{userId:e,orgId:t,isAuthenticated:!0}}catch(e){return{userId:"",orgId:void 0,isAuthenticated:!1}}}},l={getOrganizationInfo:async()=>{try{let e=(0,r.O)("/api/org/info"),t=r.n.get(e);if(t)return t;console.log("\uD83D\uDD0D Fetching organization info from:","".concat(n,"/api/org/info"));try{let t=await (0,o.v)("/api/org/info");return r.n.set(e,t,3e5),t}catch(a){console.warn("Organization endpoint not available, using mock data:",a);let t={user:{email:"user@example.com"},organization:{name:"Demo Organization",email:"org@example.com",plan_id:"free"}};return r.n.set(e,t,6e4),t}}catch(e){throw console.error("Error fetching organization info:",e),console.error("Error details:",{name:e instanceof Error?e.name:"Unknown",message:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0}),e}},updateOrganization:async e=>{try{console.log("\uD83C\uDFE2 Updating organization:",{name:e.name,email:e.email.substring(0,3)+"***"}),console.log("\uD83D\uDD0D Calling organization update endpoint:","".concat(n,"/api/org/update"));try{let t=await (0,o.v)("/api/org/update",{method:"PATCH",body:JSON.stringify(e)});if(console.log("✅ Organization update response:",t),t&&"object"==typeof t){if("success"in t)return r.n.deleteMatching("/api/org"),t;if("message"in t){let a={success:!0,message:t.message,organization:{name:e.name,email:e.email}};return r.n.deleteMatching("/api/org"),a}}console.log("⚠️ Unexpected response format, creating success response");let a={success:!0,message:"Organization updated successfully",organization:{name:e.name,email:e.email}};return r.n.deleteMatching("/api/org"),a}catch(a){for(let t of(console.warn("Organization update endpoint failed, trying alternative paths..."),["/api/user/organization/update","/api/settings/org/update"]))try{console.log("\uD83D\uDD04 Trying alternative endpoint: ".concat(t));let a=await (0,o.v)(t,{method:"PATCH",body:JSON.stringify(e)});return console.log("✅ Success with endpoint: ".concat(t)),r.n.deleteMatching("/api/org"),a}catch(e){console.log("❌ Failed with endpoint: ".concat(t),e);continue}console.warn("All organization endpoints failed, returning mock success response"),console.warn("Original error:",a);let t={success:!0,message:"Organization updated successfully (mock response - backend endpoint not available)",organization:{name:e.name,email:e.email}};return r.n.deleteMatching("/api/org"),t}}catch(e){throw console.error("Error updating organization:",e),console.error("Error details:",{name:e instanceof Error?e.name:"Unknown",message:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0}),e}},getChatbots:async()=>{try{let e=await (0,o.v)("/api/org/chatbots");return e.chatbots||e||[]}catch(e){throw console.error("Error fetching organization chatbots:",e),e}}}},6948:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>i,Zp:()=>n,aR:()=>s});var o=a(5155);a(2115);var r=a(4269);function n(e){let{className:t,...a}=e;return(0,o.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function s(e){let{className:t,...a}=e;return(0,o.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,o.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function c(e){let{className:t,...a}=e;return(0,o.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,o.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...a})}},7228:(e,t,a)=>{a.d(t,{O:()=>n,n:()=>r});class o{set(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e5;this.cache.set(e,{data:t,timestamp:Date.now(),ttl:a})}get(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}clear(){this.cache.clear()}delete(e){return this.cache.delete(e)}has(e){let t=this.cache.get(e);return!!t&&(!(Date.now()-t.timestamp>t.ttl)||(this.cache.delete(e),!1))}getKeysMatching(e){let t=[];for(let a of this.cache.keys())a.includes(e)&&t.push(a);return t}deleteMatching(e){let t=this.getKeysMatching(e);return t.forEach(e=>this.cache.delete(e)),t.length}cleanup(){let e=Date.now();for(let[t,a]of this.cache.entries())e-a.timestamp>a.ttl&&this.cache.delete(t)}constructor(){this.cache=new Map}}let r=new o;setInterval(()=>{r.cleanup()},3e5);let n=(e,t)=>{let a=t?JSON.stringify(t):"";return"".concat(e).concat(a)}}}]);
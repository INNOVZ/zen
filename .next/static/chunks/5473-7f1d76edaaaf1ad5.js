"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5473],{991:(t,e,n)=>{n.d(e,{k:()=>i});var a=n(5155);n(2115);var r=n(6657),o=n(4269);function i(t){let{className:e,value:n,...i}=t;return(0,a.jsx)(r.bL,{"data-slot":"progress",className:(0,o.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...i,children:(0,a.jsx)(r.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})}},1539:(t,e,n)=>{n.d(e,{Rs:()=>l,SubscriptionProvider:()=>s});var a=n(5155),r=n(2115),o=n(2504),i=n(1643);let c=(0,r.createContext)(void 0),s=t=>{let{children:e}=t,[n,s]=(0,r.useState)(null),[l,u]=(0,r.useState)(null),[p,h]=(0,r.useState)(!0),[d,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let t=await o.k.getPlans();u(t)}catch(t){console.error("Failed to load subscription plans:",t),g("Failed to load subscription plans")}})()},[]),(0,r.useEffect)(()=>{let t=async()=>{try{h(!0),g(null);let{userId:t,orgId:e}=await (0,i.F)(),n=await o.k.getSubscriptionStatus(e?"organization":"user",e||t);s(n)}catch(t){console.error("Failed to load subscription status:",t),t instanceof Error&&!t.message.includes("Not authenticated")&&g("Failed to load subscription status")}finally{h(!1)}};t();let e=setInterval(t,3e4);return()=>clearInterval(e)},[]);let b=async()=>{try{g(null);let{userId:t,orgId:e}=await (0,i.F)(),n=await o.k.getSubscriptionStatus(e?"organization":"user",e||t);s(n)}catch(t){console.error("Failed to refresh subscription status:",t),g("Failed to refresh subscription status")}},f=async t=>{try{let{userId:e,orgId:n}=await (0,i.F)();return await o.k.checkTokenAvailability(n?"organization":"user",n||e,t)}catch(t){throw console.error("Failed to check token availability:",t),t}},m=async t=>{try{let e=await o.k.consumeTokens(t);return await b(),e}catch(t){throw console.error("Failed to consume tokens:",t),t}};return(0,a.jsx)(c.Provider,{value:{subscription:n,plans:l,isLoading:p,error:d,refreshSubscription:b,checkTokenAvailability:f,consumeTokens:m},children:e})},l=()=>{let t=(0,r.useContext)(c);if(void 0===t)throw Error("useSubscription must be used within a SubscriptionProvider");return t}},2504:(t,e,n)=>{n.d(e,{k:()=>i});var a=n(1643),r=n(7228);let o="http://localhost:8001",i={getPlans:async()=>{let t=(0,r.O)("/api/onboarding/plans"),e=r.n.get(t);if(e)return e;try{let e=await fetch("".concat(o,"/api/onboarding/plans"));if(!e.ok)throw Error("Failed to fetch plans: ".concat(e.status));let n=await e.json(),a=n.plans||n;return r.n.set(t,a,36e5),a}catch(n){console.error("Error fetching subscription plans:",n);let e={basic:{name:"Basic Plan",monthly_token_limit:1e4,price_per_month:29.99,max_chatbots:3,max_documents_per_chatbot:50,priority_support:!1,custom_branding:!1,api_access:!1,analytics_retention_days:30},professional:{name:"Professional Plan",monthly_token_limit:5e4,price_per_month:99.99,max_chatbots:10,max_documents_per_chatbot:200,priority_support:!0,custom_branding:!0,api_access:!0,analytics_retention_days:90},enterprise:{name:"Enterprise Plan",monthly_token_limit:2e5,price_per_month:299.99,max_chatbots:50,max_documents_per_chatbot:1e3,priority_support:!0,custom_branding:!0,api_access:!0,analytics_retention_days:365}};return r.n.set(t,e,3e5),e}},signup:async t=>{try{let e=new AbortController,n=setTimeout(()=>e.abort(),3e4),a=await fetch("".concat(o,"/api/onboarding/admin/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),signal:e.signal});if(clearTimeout(n),!a.ok){let t=await a.json();throw Error(t.detail||"Signup failed: ".concat(a.status))}return await a.json()}catch(t){if(console.error("Error during signup:",t),t instanceof Error&&"AbortError"===t.name)throw Error("Request timed out. Please check if the server is running.");throw t}},getSubscriptionStatus:async(t,e)=>{let n=(0,r.O)("/api/onboarding/subscription/".concat(t,"/").concat(e)),a=r.n.get(n);if(a)return a;try{let a=await fetch("".concat(o,"/api/onboarding/subscription/").concat(t,"/").concat(e));if(!a.ok)throw Error("Failed to fetch subscription status: ".concat(a.status));let i=await a.json();return r.n.set(n,i,3e4),i}catch(e){console.error("Error fetching subscription status:",e);let t={subscription_id:"mock-subscription-id",tokens_used_this_month:2500,tokens_remaining:7500,monthly_limit:1e4,usage_percentage:25,reset_date:new Date(Date.now()+2592e6).toISOString()};return r.n.set(n,t,6e4),t}},consumeTokens:async t=>{try{let{token:e,userId:n,orgId:i}=await (0,a.F)(),c={"Content-Type":"application/json",Authorization:"Bearer ".concat(e),"X-User-ID":n};i&&(c["X-Org-ID"]=i);let s=await fetch("".concat(o,"/api/onboarding/tokens/consume"),{method:"POST",headers:c,body:JSON.stringify(t)});if(!s.ok){let t=await s.json();throw Error(t.detail||"Token consumption failed: ".concat(s.status))}let l=await s.json();return r.n.deleteMatching("/api/onboarding/subscription"),l}catch(t){throw console.error("Error consuming tokens:",t),t}},checkTokenAvailability:async(t,e,n)=>{try{let a=await fetch("".concat(o,"/api/onboarding/tokens/check/").concat(t,"/").concat(e,"/").concat(n));if(!a.ok)throw Error("Token availability check failed: ".concat(a.status));return await a.json()}catch(t){return console.error("Error checking token availability:",t),{success:!0,has_enough_tokens:!0,tokens_required:n,tokens_available:7500,can_proceed:!0}}},getSupportedChannels:async()=>{let t=(0,r.O)("/api/onboarding/channels"),e=r.n.get(t);if(e)return e;try{let e=await fetch("".concat(o,"/api/onboarding/channels"));if(!e.ok)throw Error("Failed to fetch channels: ".concat(e.status));let n=await e.json(),a=n.channels||n;return r.n.set(t,a,36e5),a}catch(n){console.error("Error fetching supported channels:",n);let e={website:{name:"Website Chat",description:"Embedded chat widget on websites",icon:"\uD83C\uDF10",typical_use_cases:["Customer support","Lead generation","FAQ"]},whatsapp:{name:"WhatsApp Business",description:"WhatsApp Business API integration",icon:"\uD83D\uDCF1",typical_use_cases:["Customer service","Order updates","Marketing"]},messenger:{name:"Facebook Messenger",description:"Facebook Messenger integration",icon:"\uD83D\uDCAC",typical_use_cases:["Social commerce","Customer support","Engagement"]},instagram:{name:"Instagram Direct",description:"Instagram Direct Messages integration",icon:"\uD83D\uDCF8",typical_use_cases:["Brand engagement","Product inquiries","Support"]},api:{name:"REST API",description:"API integration for custom applications",icon:"\uD83D\uDD0C",typical_use_cases:["Custom apps","System integration","Automation"]},mobile_app:{name:"Mobile App",description:"Mobile application integration",icon:"\uD83D\uDCF2",typical_use_cases:["In-app support","User onboarding","Feature guidance"]}};return r.n.set(t,e,36e5),e}},getChannelConfigurations:async t=>{let e=(0,r.O)("/api/onboarding/subscription/".concat(t,"/channels/config")),n=r.n.get(e);if(n)return n;try{let n=await fetch("".concat(o,"/api/onboarding/subscription/").concat(t,"/channels/config"));if(!n.ok)throw Error("Failed to fetch channel configurations: ".concat(n.status));let a=await n.json(),i=a.configurations||a;return r.n.set(e,i,3e5),i}catch(t){throw console.error("Error fetching channel configurations:",t),t}},updateChannelConfiguration:async(t,e,n)=>{try{let{token:i,userId:c,orgId:s}=await (0,a.F)(),l={"Content-Type":"application/json",Authorization:"Bearer ".concat(i),"X-User-ID":c};s&&(l["X-Org-ID"]=s);let u=await fetch("".concat(o,"/api/onboarding/subscription/").concat(t,"/channels/").concat(e,"/config"),{method:"PUT",headers:l,body:JSON.stringify(n)});if(!u.ok){let t=await u.json();throw Error(t.detail||"Channel configuration update failed: ".concat(u.status))}let p=await u.json();return r.n.deleteMatching("/api/onboarding/subscription/".concat(t,"/channels")),p}catch(t){throw console.error("Error updating channel configuration:",t),t}},getSubscriptionAnalytics:async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(!t)throw Error("Subscription ID is required");let n=(0,r.O)("/api/onboarding/analytics/".concat(t,"?days_back=").concat(e)),a=r.n.get(n);if(a)return a;try{let a=new AbortController,i=setTimeout(()=>a.abort(),3e4),c=await fetch("".concat(o,"/api/onboarding/analytics/").concat(t,"?days_back=").concat(e),{signal:a.signal});if(clearTimeout(i),!c.ok){let t=(await c.json().catch(()=>({}))).detail||"Failed to fetch analytics: ".concat(c.status);throw Error(t)}let s=await c.json(),l=s.analytics||s;return r.n.set(n,l,3e5),l}catch(t){if(console.error("Error fetching subscription analytics:",t),t instanceof Error&&"AbortError"===t.name)throw Error("Request timed out. Please check if the server is running.");throw t}},getChannelComparison:async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=(0,r.O)("/api/onboarding/analytics/".concat(t,"/channels/comparison?days_back=").concat(e)),a=r.n.get(n);if(a)return a;try{let a=await fetch("".concat(o,"/api/onboarding/analytics/").concat(t,"/channels/comparison?days_back=").concat(e));if(!a.ok)throw Error("Failed to fetch channel comparison: ".concat(a.status));let i=await a.json(),c=i.comparison||i;return r.n.set(n,c,3e5),c}catch(t){throw console.error("Error fetching channel comparison:",t),t}},getChannelTrends:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,a=(0,r.O)("/api/onboarding/analytics/".concat(t,"/channels/").concat(e,"/trends?days_back=").concat(n)),i=r.n.get(a);if(i)return i;try{let i=await fetch("".concat(o,"/api/onboarding/analytics/").concat(t,"/channels/").concat(e,"/trends?days_back=").concat(n));if(!i.ok)throw Error("Failed to fetch channel trends: ".concat(i.status));let c=await i.json(),s=c.trends||c;return r.n.set(a,s,3e5),s}catch(t){throw console.error("Error fetching channel trends:",t),t}},estimateTokensForOperation:(t,e,n)=>{switch(t){case"chat":return 100+(e||0)/4;case"document_upload":return 500+(n||0)/100;case"document_processing":return 200;case"web_scraping":return 300;case"embedding_generation":return 50;default:return 100}},invalidateSubscriptionCache:()=>{r.n.deleteMatching("/api/onboarding"),console.log("Subscription cache invalidated")}}}}]);